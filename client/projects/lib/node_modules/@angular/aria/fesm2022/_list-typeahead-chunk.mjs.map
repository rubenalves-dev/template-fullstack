{"version":3,"file":"_list-typeahead-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/list-selection/list-selection.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/list-typeahead/list-typeahead.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal, SignalLike, WritableSignalLike} from '../signal-like/signal-like';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../list-focus/list-focus';\n\n/** Represents an item in a collection, such as a listbox option, that can be selected. */\nexport interface ListSelectionItem<V> extends ListFocusItem {\n  /** The value of the item. */\n  value: SignalLike<V>;\n\n  /** Whether the item is selectable. */\n  selectable: SignalLike<boolean>;\n}\n\n/** Represents the required inputs for a collection that contains selectable items. */\nexport interface ListSelectionInputs<T extends ListSelectionItem<V>, V> extends ListFocusInputs<T> {\n  /** Whether multiple items in the list can be selected at once. */\n  multi: SignalLike<boolean>;\n\n  /** The current value of the list selection. */\n  values: WritableSignalLike<V[]>;\n\n  /** The selection strategy used by the list. */\n  selectionMode: SignalLike<'follow' | 'explicit'>;\n}\n\n/** Controls selection for a list of items. */\nexport class ListSelection<T extends ListSelectionItem<V>, V> {\n  /** The start index to use for range selection. */\n  rangeStartIndex = signal<number>(0);\n\n  /** The end index to use for range selection. */\n  rangeEndIndex = signal<number>(0);\n\n  /** The currently selected items. */\n  selectedItems = computed(() =>\n    this.inputs.items().filter(item => this.inputs.values().includes(item.value())),\n  );\n\n  constructor(readonly inputs: ListSelectionInputs<T, V> & {focusManager: ListFocus<T>}) {}\n\n  /** Selects the item at the current active index. */\n  select(item?: ListSelectionItem<V>, opts = {anchor: true}) {\n    item = item ?? (this.inputs.focusManager.inputs.activeItem() as ListSelectionItem<V>);\n\n    if (\n      !item ||\n      item.disabled() ||\n      !item.selectable() ||\n      !this.inputs.focusManager.isFocusable(item as T) ||\n      this.inputs.values().includes(item.value())\n    ) {\n      return;\n    }\n\n    if (!this.inputs.multi()) {\n      this.deselectAll();\n    }\n\n    const index = this.inputs.items().findIndex(i => i === item);\n    if (opts.anchor) {\n      this.beginRangeSelection(index);\n    }\n    this.inputs.values.update(values => values.concat(item.value()));\n  }\n\n  /** Deselects the item at the current active index. */\n  deselect(item?: ListSelectionItem<V>) {\n    item = item ?? this.inputs.focusManager.inputs.activeItem();\n\n    if (item && !item.disabled() && item.selectable()) {\n      this.inputs.values.update(values => values.filter(value => value !== item.value()));\n    }\n  }\n\n  /** Toggles the item at the current active index. */\n  toggle(item?: ListSelectionItem<V>) {\n    item = item ?? this.inputs.focusManager.inputs.activeItem();\n    if (item) {\n      this.inputs.values().includes(item.value()) ? this.deselect(item) : this.select(item);\n    }\n  }\n\n  /** Toggles only the item at the current active index. */\n  toggleOne() {\n    const item = this.inputs.focusManager.inputs.activeItem();\n    if (item) {\n      this.inputs.values().includes(item.value()) ? this.deselect() : this.selectOne();\n    }\n  }\n\n  /** Selects all items in the list. */\n  selectAll() {\n    if (!this.inputs.multi()) {\n      return; // Should we log a warning?\n    }\n\n    for (const item of this.inputs.items()) {\n      this.select(item, {anchor: false});\n    }\n\n    this.beginRangeSelection();\n  }\n\n  /** Deselects all items in the list. */\n  deselectAll() {\n    // If an item is not in the list, it forcefully gets deselected.\n    // This actually creates a bug for the following edge case:\n    //\n    // Setup: An item is not in the list (maybe it's lazily loaded), and it is disabled & selected.\n    // Expected: If deselectAll() is called, it should NOT get deselected (because it is disabled).\n    // Actual: Calling deselectAll() will still deselect the item.\n    //\n    // Why? Because we can't check if the item is disabled if it's not in the list.\n    //\n    // Alternatively, we could NOT deselect items that are not in the list, but this has the\n    // inverse (and more common) effect of keeping enabled items selected when they aren't in the\n    // list.\n\n    for (const value of this.inputs.values()) {\n      const item = this.inputs.items().find(i => i.value() === value);\n\n      item\n        ? this.deselect(item)\n        : this.inputs.values.update(values => values.filter(v => v !== value));\n    }\n  }\n\n  /**\n   * Selects all items in the list or deselects all\n   * items in the list if all items are already selected.\n   */\n  toggleAll() {\n    const selectableValues = this.inputs\n      .items()\n      .filter(i => !i.disabled() && i.selectable() && this.inputs.focusManager.isFocusable(i))\n      .map(i => i.value());\n\n    selectableValues.every(i => this.inputs.values().includes(i))\n      ? this.deselectAll()\n      : this.selectAll();\n  }\n\n  /** Sets the selection to only the current active item. */\n  selectOne() {\n    const item = this.inputs.focusManager.inputs.activeItem();\n    if (item && (item.disabled() || !item.selectable())) {\n      return;\n    }\n\n    this.deselectAll();\n\n    if (this.inputs.values().length > 0 && !this.inputs.multi()) {\n      return;\n    }\n\n    this.select();\n  }\n\n  /**\n   * Selects all items in the list up to the anchor item.\n   *\n   * Deselects all items that were previously within the\n   * selected range that are now outside of the selected range\n   */\n  selectRange(opts = {anchor: true}) {\n    const isStartOfRange = this.inputs.focusManager.prevActiveIndex() === this.rangeStartIndex();\n\n    if (isStartOfRange && opts.anchor) {\n      this.beginRangeSelection(this.inputs.focusManager.prevActiveIndex());\n    }\n\n    const itemsInRange = this._getItemsFromIndex(this.rangeStartIndex());\n    const itemsOutOfRange = this._getItemsFromIndex(this.rangeEndIndex()).filter(\n      i => !itemsInRange.includes(i),\n    );\n\n    for (const item of itemsOutOfRange) {\n      this.deselect(item);\n    }\n\n    for (const item of itemsInRange) {\n      this.select(item, {anchor: false});\n    }\n\n    if (itemsInRange.length) {\n      const item = itemsInRange.pop();\n      const index = this.inputs.items().findIndex(i => i === item);\n      this.rangeEndIndex.set(index);\n    }\n  }\n\n  /** Marks the given index as the start of a range selection. */\n  beginRangeSelection(index: number = this.inputs.focusManager.activeIndex()) {\n    this.rangeStartIndex.set(index);\n    this.rangeEndIndex.set(index);\n  }\n\n  /** Returns the items in the list starting from the given index.  */\n  private _getItemsFromIndex(index: number) {\n    if (index === -1) {\n      return [];\n    }\n\n    const upper = Math.max(this.inputs.focusManager.activeIndex(), index);\n    const lower = Math.min(this.inputs.focusManager.activeIndex(), index);\n\n    const items = [];\n    for (let i = lower; i <= upper; i++) {\n      items.push(this.inputs.items()[i]);\n    }\n\n    if (this.inputs.focusManager.activeIndex() < index) {\n      return items.reverse();\n    }\n\n    return items;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal, SignalLike} from '../signal-like/signal-like';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../list-focus/list-focus';\n\n/**\n * Represents an item in a collection, such as a listbox option, than can be navigated to by\n * typeahead.\n */\nexport interface ListTypeaheadItem extends ListFocusItem {\n  /** The text used by the typeahead search. */\n  searchTerm: SignalLike<string>;\n}\n\n/**\n * Represents the required inputs for a collection that contains items that can be navigated to by\n * typeahead.\n */\nexport interface ListTypeaheadInputs<T extends ListTypeaheadItem> extends ListFocusInputs<T> {\n  /** The amount of time before the typeahead search is reset. */\n  typeaheadDelay: SignalLike<number>;\n}\n\n/** Controls typeahead for a list of items. */\nexport class ListTypeahead<T extends ListTypeaheadItem> {\n  /** A reference to the timeout for resetting the typeahead search. */\n  timeout?: ReturnType<typeof setTimeout> | undefined;\n\n  /** The focus controller of the parent list. */\n  focusManager: ListFocus<T>;\n\n  /** Whether the user is actively typing a typeahead search query. */\n  isTyping = computed(() => this._query().length > 0);\n\n  /** Keeps track of the characters that typeahead search is being called with. */\n  private _query = signal('');\n\n  /** The index where that the typeahead search was initiated from. */\n  private _startIndex = signal<number | undefined>(undefined);\n\n  constructor(readonly inputs: ListTypeaheadInputs<T> & {focusManager: ListFocus<T>}) {\n    this.focusManager = inputs.focusManager;\n  }\n\n  /** Performs a typeahead search, appending the given character to the search string. */\n  search(char: string): boolean {\n    if (char.length !== 1) {\n      return false;\n    }\n\n    if (!this.isTyping() && char === ' ') {\n      return false;\n    }\n\n    if (this._startIndex() === undefined) {\n      this._startIndex.set(this.focusManager.activeIndex());\n    }\n\n    clearTimeout(this.timeout);\n    this._query.update(q => q + char.toLowerCase());\n    const item = this._getItem();\n\n    if (item) {\n      this.focusManager.focus(item);\n    }\n\n    this.timeout = setTimeout(() => {\n      this._query.set('');\n      this._startIndex.set(undefined);\n    }, this.inputs.typeaheadDelay());\n\n    return true;\n  }\n\n  /**\n   * Returns the first item whose search term matches the\n   * current query starting from the the current anchor index.\n   */\n  private _getItem() {\n    const items = this.focusManager.inputs.items();\n    const itemCount = items.length;\n    const startIndex = this._startIndex()!;\n\n    for (let i = 0; i < itemCount; i++) {\n      const index = (startIndex + 1 + i) % itemCount;\n      const item = items[index];\n\n      if (\n        this.focusManager.isFocusable(item) &&\n        item.searchTerm().toLowerCase().startsWith(this._query())\n      ) {\n        return item;\n      }\n    }\n\n    return undefined;\n  }\n}\n"],"names":["ListSelection","inputs","rangeStartIndex","signal","rangeEndIndex","selectedItems","computed","items","filter","item","values","includes","value","constructor","select","opts","anchor","focusManager","activeItem","disabled","selectable","isFocusable","multi","deselectAll","index","findIndex","i","beginRangeSelection","update","concat","deselect","toggle","toggleOne","selectOne","selectAll","find","v","toggleAll","selectableValues","map","every","length","selectRange","isStartOfRange","prevActiveIndex","itemsInRange","_getItemsFromIndex","itemsOutOfRange","pop","set","activeIndex","upper","Math","max","lower","min","push","reverse","ListTypeahead","timeout","isTyping","_query","_startIndex","undefined","search","char","clearTimeout","q","toLowerCase","_getItem","focus","setTimeout","typeaheadDelay","itemCount","startIndex","searchTerm","startsWith"],"mappings":"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"}