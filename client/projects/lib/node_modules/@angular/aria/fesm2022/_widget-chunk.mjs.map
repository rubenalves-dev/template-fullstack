{"version":3,"file":"_widget-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/grid/grid-data.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/grid/grid-focus.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/grid/grid-navigation.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/grid/grid-selection.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/grid/grid.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/grid/grid.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/grid/row.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/grid/cell.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/grid/widget.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, SignalLike} from '../signal-like/signal-like';\n\n/** Represents coordinates in a grid. */\nexport interface RowCol {\n  /** The row index. */\n  row: number;\n\n  /** The column index. */\n  col: number;\n}\n\n/** A string representation of grid coordinates. */\ntype CoordString = `${RowCol['row']}:${RowCol['col']}`;\n\n/** The base interface for a cell in a grid. */\nexport interface BaseGridCell {\n  /** The number of rows the cell should span. */\n  rowSpan: SignalLike<number>;\n\n  /** The number of columns the cell should span. */\n  colSpan: SignalLike<number>;\n}\n\n/** Represents the required inputs for GridData. */\nexport interface GridDataInputs<T extends BaseGridCell> {\n  /** The two-dimensional array of cells that represents the grid. */\n  cells: SignalLike<T[][]>;\n}\n\n/** Controls internal coordinates for a grid of items. */\nexport class GridData<T extends BaseGridCell> {\n  /** The two-dimensional array of cells that represents the grid. */\n  readonly cells: SignalLike<T[][]>;\n\n  /** The maximum number of rows in the grid, accounting for row spans. */\n  readonly maxRowCount = computed<number>(() => Math.max(...this._rowCountByCol().values(), 0));\n\n  /** The maximum number of columns in the grid, accounting for column spans. */\n  readonly maxColCount = computed<number>(() => Math.max(...this._colCountsByRow().values(), 0));\n\n  /** A map from a cell to its primary and spanned coordinates. */\n  private readonly _coordsMap = computed<Map<T, {coords: RowCol; spanCoords: RowCol[]}>>(() => {\n    const coordsMap = new Map();\n    const visitedCoords = new Set();\n\n    for (let rowIndex = 0; rowIndex < this.cells().length; rowIndex++) {\n      let colIndex = 0;\n      const row = this.cells()[rowIndex];\n\n      for (const cell of row) {\n        // Skip past cells that are already taken.\n        while (visitedCoords.has(`${rowIndex}:${colIndex}`)) {\n          colIndex++;\n        }\n\n        const rowspan = cell.rowSpan();\n        const colspan = cell.colSpan();\n        const spanCoords: RowCol[] = [];\n\n        for (let rowOffset = 0; rowOffset < rowspan; rowOffset++) {\n          const row = rowIndex + rowOffset;\n          for (let colOffset = 0; colOffset < colspan; colOffset++) {\n            const col = colIndex + colOffset;\n            visitedCoords.add(`${row}:${col}`);\n            spanCoords.push({row, col});\n          }\n        }\n        coordsMap.set(cell, {coords: spanCoords[0], spanCoords});\n\n        colIndex += colspan;\n      }\n    }\n\n    return coordsMap;\n  });\n\n  /** A map from a coordinate string to the cell at that coordinate. */\n  private readonly _cellMap = computed<Map<CoordString, T>>(() => {\n    const cellMap = new Map();\n    for (const [cell, {spanCoords}] of this._coordsMap().entries()) {\n      for (const {row, col} of spanCoords) {\n        cellMap.set(`${row}:${col}`, cell);\n      }\n    }\n    return cellMap;\n  });\n\n  /** A map from a row index to the number of columns in that row. */\n  private readonly _colCountsByRow = computed<Map<number, number>>(() => {\n    const colCountByRow = new Map();\n    for (const [_, {spanCoords}] of this._coordsMap().entries()) {\n      for (const {row, col} of spanCoords) {\n        const colCount = colCountByRow.get(row);\n        const newColCount = col + 1;\n        if (colCount === undefined || colCount < newColCount) {\n          colCountByRow.set(row, newColCount);\n        }\n      }\n    }\n    return colCountByRow;\n  });\n\n  /** A map from a column index to the number of rows in that column. */\n  private readonly _rowCountByCol = computed<Map<number, number>>(() => {\n    const rowCountByCol = new Map();\n    for (const [_, {spanCoords}] of this._coordsMap().entries()) {\n      for (const {row, col} of spanCoords) {\n        const rowCount = rowCountByCol.get(col);\n        const newRowCount = row + 1;\n        if (rowCount === undefined || rowCount < newRowCount) {\n          rowCountByCol.set(col, newRowCount);\n        }\n      }\n    }\n    return rowCountByCol;\n  });\n\n  constructor(readonly inputs: GridDataInputs<T>) {\n    this.cells = this.inputs.cells;\n  }\n\n  /** Whether the cell exists. */\n  hasCell(cell: T): boolean {\n    return this._coordsMap().has(cell);\n  }\n\n  /** Gets the cell at the given coordinates. */\n  getCell(rowCol: RowCol): T | undefined {\n    return this._cellMap().get(`${rowCol.row}:${rowCol.col}`);\n  }\n\n  /** Gets the primary coordinates of the given cell. */\n  getCoords(cell: T): RowCol | undefined {\n    return this._coordsMap().get(cell)?.coords;\n  }\n\n  /** Gets all coordinates that the given cell spans. */\n  getAllCoords(cell: T): RowCol[] | undefined {\n    return this._coordsMap().get(cell)?.spanCoords;\n  }\n\n  /** Gets the number of rows in the given column. */\n  getRowCount(col: number): number | undefined {\n    return this._rowCountByCol().get(col);\n  }\n\n  /** Gets the number of columns in the given row. */\n  getColCount(row: number): number | undefined {\n    return this._colCountsByRow().get(row);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal, WritableSignalLike, SignalLike} from '../signal-like/signal-like';\nimport type {GridData, BaseGridCell, RowCol} from './grid-data';\n\n/** Represents an cell in a grid, such as a grid cell, that may receive focus. */\nexport interface GridFocusCell extends BaseGridCell {\n  /** A unique identifier for the cell. */\n  id: SignalLike<string>;\n\n  /** The html element that should receive focus. */\n  element: SignalLike<HTMLElement>;\n\n  /** Whether a cell is disabled. */\n  disabled: SignalLike<boolean>;\n}\n\n/** Represents the required inputs for a grid that contains focusable cells. */\nexport interface GridFocusInputs {\n  /** The focus strategy used by the grid. */\n  focusMode: SignalLike<'roving' | 'activedescendant'>;\n\n  /** Whether the grid is disabled. */\n  disabled: SignalLike<boolean>;\n\n  /** Whether disabled cells in the grid should be focusable. */\n  softDisabled: SignalLike<boolean>;\n}\n\n/** Dependencies for the `GridFocus` class. */\ninterface GridFocusDeps<T extends GridFocusCell> {\n  /** The `GridData` instance that this focus manager operates on. */\n  grid: GridData<T>;\n}\n\n/** Controls focus for a 2D grid of cells. */\nexport class GridFocus<T extends GridFocusCell> {\n  /** The current active cell. */\n  readonly activeCell: WritableSignalLike<T | undefined> = signal(undefined);\n\n  /** The current active cell coordinates. */\n  readonly activeCoords = signal<RowCol>({row: -1, col: -1});\n\n  /** Whether the grid active state is empty (no active cell or coordinates). */\n  readonly stateEmpty = computed(\n    () =>\n      this.activeCell() === undefined ||\n      (this.activeCoords().row === -1 && this.activeCoords().col === -1),\n  );\n\n  /**\n   * Whether the grid focus state is stale.\n   *\n   * A stale state means the active cell or coordinates are no longer valid based on the\n   * current grid data, for example if the underlying cells have changed.\n   * A stale state should be re-initialized.\n   */\n  readonly stateStale = computed(() => {\n    if (this.stateEmpty()) {\n      return true;\n    }\n\n    const activeCell = this.activeCell();\n    const activeCellCoords = this.inputs.grid.getCoords(activeCell!);\n    const activeCoords = this.activeCoords();\n    const activeCoordsCell = this.inputs.grid.getCell(activeCoords);\n\n    const activeCellNotValid = activeCellCoords === undefined;\n    const activeCellMismatch = activeCell !== activeCoordsCell;\n    return activeCellNotValid || activeCellMismatch;\n  });\n\n  /** The id of the current active cell, for ARIA activedescendant. */\n  readonly activeDescendant = computed<string | undefined>(() => {\n    if (this.gridDisabled() || this.inputs.focusMode() === 'roving') {\n      return undefined;\n    }\n    const currentActiveCell = this.activeCell();\n    return currentActiveCell ? currentActiveCell.id() : undefined;\n  });\n\n  /** Whether the grid is in a disabled state. */\n  readonly gridDisabled = computed<boolean>(() => {\n    if (this.inputs.disabled()) {\n      return true;\n    }\n    const gridCells = this.inputs.grid.cells();\n    return gridCells.length === 0 || gridCells.every(row => row.every(cell => cell.disabled()));\n  });\n\n  /** The tab index for the grid container. */\n  readonly gridTabIndex = computed<-1 | 0>(() => {\n    if (this.gridDisabled()) {\n      return 0;\n    }\n    return this.inputs.focusMode() === 'activedescendant' ? 0 : -1;\n  });\n\n  constructor(readonly inputs: GridFocusInputs & GridFocusDeps<T>) {}\n\n  /** Returns the tab index for the given grid cell cell. */\n  getCellTabIndex(cell: T): -1 | 0 {\n    if (this.gridDisabled()) {\n      return -1;\n    }\n    if (this.inputs.focusMode() === 'activedescendant') {\n      return -1;\n    }\n    return this.activeCell() === cell ? 0 : -1;\n  }\n\n  /** Returns true if the given cell can be navigated to. */\n  isFocusable(cell: T): boolean {\n    return this.inputs.grid.hasCell(cell) && (!cell.disabled() || this.inputs.softDisabled());\n  }\n\n  /** Focuses the given cell. */\n  focusCell(cell: T): boolean {\n    if (this.gridDisabled()) {\n      return false;\n    }\n\n    if (!this.isFocusable(cell)) {\n      return false;\n    }\n\n    if (this.inputs.grid.getCoords(cell) === undefined) {\n      return false;\n    }\n\n    this.activeCoords.set(this.inputs.grid.getCoords(cell)!);\n    this.activeCell.set(cell);\n\n    return true;\n  }\n\n  /** Moves focus to the cell at the given coordinates if it's part of a focusable cell. */\n  focusCoordinates(coords: RowCol): boolean {\n    if (this.gridDisabled()) {\n      return false;\n    }\n\n    const cell = this.inputs.grid.getCell(coords);\n\n    if (!cell || !this.isFocusable(cell)) {\n      return false;\n    }\n\n    if (this.inputs.grid.getCell(coords) === undefined) {\n      return false;\n    }\n\n    this.activeCoords.set(coords);\n    this.activeCell.set(this.inputs.grid.getCell(coords));\n\n    return true;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {SignalLike, computed} from '../signal-like/signal-like';\nimport {GridFocus, GridFocusCell, GridFocusInputs} from './grid-focus';\nimport {GridData, RowCol} from './grid-data';\n\n/** A utility type that ensures an object has exactly one key from a given set. */\ntype ExactlyOneKey<T, K extends keyof T = keyof T> = {\n  [P in K]: Record<P, T[P]> & Partial<Record<Exclude<K, P>, never>>;\n}[K];\n\n/** Represents a directional change in the grid, either by row or by column. */\ntype Delta = ExactlyOneKey<{row: -1 | 1; col: -1 | 1}>;\n\n/** Constants for the four cardinal directions. */\nexport const direction: Record<'Up' | 'Down' | 'Left' | 'Right', Delta> = {\n  Up: {row: -1},\n  Down: {row: 1},\n  Left: {col: -1},\n  Right: {col: 1},\n} as const;\n\n/** The wrapping behavior for keyboard navigation. */\nexport type WrapStrategy = 'continuous' | 'loop' | 'nowrap';\n\n/** Represents an item in a collection, such as a listbox option, than can be navigated to. */\nexport interface GridNavigationCell extends GridFocusCell {}\n\n/** Represents the required inputs for a collection that has navigable items. */\nexport interface GridNavigationInputs extends GridFocusInputs {\n  /** The wrapping behavior for keyboard navigation along the row axis. */\n  rowWrap: SignalLike<WrapStrategy>;\n\n  /** The wrapping behavior for keyboard navigation along the column axis. */\n  colWrap: SignalLike<WrapStrategy>;\n}\n\n/** Dependencies for the `GridNavigation` class. */\ninterface GridNavigationDeps<T extends GridNavigationCell> {\n  /** The `GridData` instance that this navigation manager operates on. */\n  grid: GridData<T>;\n\n  /** The `GridFocus` instance that this navigation manager uses to manage focus. */\n  gridFocus: GridFocus<T>;\n}\n\n/** Controls navigation for a grid of items. */\nexport class GridNavigation<T extends GridNavigationCell> {\n  /** The maximum number of steps to take when searching for the next cell. */\n  private _maxSteps = computed<number>(\n    () => this.inputs.grid.maxRowCount() * this.inputs.grid.maxColCount(),\n  );\n\n  constructor(readonly inputs: GridNavigationInputs & GridNavigationDeps<T>) {}\n\n  /** Navigates to the given item. */\n  gotoCell(cell: T): boolean {\n    return this.inputs.gridFocus.focusCell(cell);\n  }\n\n  /** Navigates to the given coordinates. */\n  gotoCoords(coords: RowCol): boolean {\n    return this.inputs.gridFocus.focusCoordinates(coords);\n  }\n\n  /**\n   * Gets the coordinates of the next focusable cell in a given direction, without changing focus.\n   */\n  peek(\n    direction: Delta,\n    fromCoords: RowCol,\n    wrap?: WrapStrategy,\n    allowDisabled?: boolean,\n  ): RowCol | undefined {\n    wrap = wrap ?? (direction.row !== undefined ? this.inputs.rowWrap() : this.inputs.colWrap());\n    return this._peekDirectional(direction, fromCoords, wrap, allowDisabled);\n  }\n\n  /**\n   * Navigates to the next focusable cell in a given direction.\n   */\n  advance(direction: Delta): boolean {\n    const nextCoords = this.peek(direction, this.inputs.gridFocus.activeCoords());\n    return !!nextCoords && this.gotoCoords(nextCoords);\n  }\n\n  /**\n   * Gets the coordinates of the first focusable cell.\n   * If a row is not provided, searches the entire grid.\n   */\n  peekFirst(row?: number, allowDisabled?: boolean): RowCol | undefined {\n    const fromCoords = {\n      row: row ?? 0,\n      col: -1,\n    };\n    return row === undefined\n      ? this._peekDirectional(direction.Right, fromCoords, 'continuous', allowDisabled)\n      : this._peekDirectional(direction.Right, fromCoords, 'nowrap', allowDisabled);\n  }\n\n  /**\n   * Navigates to the first focusable cell.\n   * If a row is not provided, searches the entire grid.\n   */\n  first(row?: number): boolean {\n    const nextCoords = this.peekFirst(row);\n    return !!nextCoords && this.gotoCoords(nextCoords);\n  }\n\n  /**\n   * Gets the coordinates of the last focusable cell.\n   * If a row is not provided, searches the entire grid.\n   */\n  peekLast(row?: number, allowDisabled?: boolean): RowCol | undefined {\n    const fromCoords = {\n      row: row ?? this.inputs.grid.maxRowCount() - 1,\n      col: this.inputs.grid.maxColCount(),\n    };\n    return row === undefined\n      ? this._peekDirectional(direction.Left, fromCoords, 'continuous', allowDisabled)\n      : this._peekDirectional(direction.Left, fromCoords, 'nowrap', allowDisabled);\n  }\n\n  /**\n   * Navigates to the last focusable cell.\n   * If a row is not provided, searches the entire grid.\n   */\n  last(row?: number): boolean {\n    const nextCoords = this.peekLast(row);\n    return !!nextCoords && this.gotoCoords(nextCoords);\n  }\n\n  /**\n   * Finds the next focusable cell in a given direction based on the wrapping behavior.\n   */\n  private _peekDirectional(\n    delta: Delta,\n    fromCoords: RowCol,\n    wrap: 'continuous' | 'loop' | 'nowrap',\n    allowDisabled: boolean = false,\n  ): RowCol | undefined {\n    if (this.inputs.gridFocus.gridDisabled()) return undefined;\n\n    const fromCell = this.inputs.grid.getCell(fromCoords);\n    const maxRowCount = this.inputs.grid.maxRowCount();\n    const maxColCount = this.inputs.grid.maxColCount();\n    const rowDelta = delta.row ?? 0;\n    const colDelta = delta.col ?? 0;\n    let nextCoords = {...fromCoords};\n\n    for (let step = 0; step < this._maxSteps(); step++) {\n      const isWrapping =\n        nextCoords.col + colDelta < 0 ||\n        nextCoords.col + colDelta >= maxColCount ||\n        nextCoords.row + rowDelta < 0 ||\n        nextCoords.row + rowDelta >= maxRowCount;\n\n      if (wrap === 'nowrap' && isWrapping) return undefined;\n\n      if (wrap === 'continuous') {\n        const generalDelta = delta.row ?? delta.col;\n        const rowStep = isWrapping ? generalDelta : rowDelta;\n        const colStep = isWrapping ? generalDelta : colDelta;\n\n        // Reaching start or end.\n        const bothWrapping =\n          (nextCoords.row + rowStep >= maxRowCount && nextCoords.col + colStep >= maxColCount) ||\n          (nextCoords.row + rowStep < 0 && nextCoords.col + colStep < 0);\n        if (bothWrapping) return undefined;\n\n        nextCoords = {\n          row: (nextCoords.row + rowStep + maxRowCount) % maxRowCount,\n          col: (nextCoords.col + colStep + maxColCount) % maxColCount,\n        };\n      }\n\n      if (wrap === 'loop') {\n        nextCoords = {\n          row: (nextCoords.row + rowDelta + maxRowCount) % maxRowCount,\n          col: (nextCoords.col + colDelta + maxColCount) % maxColCount,\n        };\n      }\n\n      if (wrap === 'nowrap') {\n        nextCoords = {\n          row: nextCoords.row + rowDelta,\n          col: nextCoords.col + colDelta,\n        };\n      }\n\n      // Back to original coordinates.\n      if (nextCoords.row === fromCoords.row && nextCoords.col === fromCoords.col) {\n        return undefined;\n      }\n\n      const nextCell = this.inputs.grid.getCell(nextCoords);\n      if (\n        nextCell !== undefined &&\n        nextCell !== fromCell &&\n        (allowDisabled || this.inputs.gridFocus.isFocusable(nextCell))\n      ) {\n        return nextCoords;\n      }\n    }\n\n    return undefined;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {GridFocus, GridFocusCell, GridFocusInputs} from './grid-focus';\nimport {GridData, RowCol} from './grid-data';\nimport {SignalLike, WritableSignalLike, signal} from '../signal-like/signal-like';\n\n/** Represents a cell in a grid that can be selected. */\nexport interface GridSelectionCell extends GridFocusCell {\n  /** Whether the cell is selected. */\n  selected: WritableSignalLike<boolean>;\n\n  /** Whether the cell is selectable. */\n  selectable: SignalLike<boolean>;\n}\n\n/** Represents the required inputs for a grid that has selectable cells. */\nexport interface GridSelectionInputs extends GridFocusInputs {}\n\n/** Dependencies for the `GridSelection` class. */\ninterface GridSelectionDeps<T extends GridSelectionCell> {\n  /** The `GridData` instance that this selection manager operates on. */\n  grid: GridData<T>;\n\n  /** The `GridFocus` instance that this selection manager uses to manage focus. */\n  gridFocus: GridFocus<T>;\n}\n\n/** Controls selection for a grid of items. */\nexport class GridSelection<T extends GridSelectionCell> {\n  /** The list of cells that were changed in the last selection operation. */\n  private readonly _undoList: WritableSignalLike<[T, boolean][]> = signal([]);\n\n  constructor(readonly inputs: GridSelectionInputs & GridSelectionDeps<T>) {}\n\n  /** Reverts the last selection change. */\n  undo(): void {\n    for (const [cell, oldState] of this._undoList()) {\n      cell.selected.set(oldState);\n    }\n    this._undoList.set([]);\n  }\n\n  /** Selects one or more cells in a given range. */\n  select(fromCoords: RowCol, toCoords?: RowCol): void {\n    this._updateState(fromCoords, toCoords ?? fromCoords, () => true);\n  }\n\n  /** Deselects one or more cells in a given range. */\n  deselect(fromCoords: RowCol, toCoords?: RowCol): void {\n    this._updateState(fromCoords, toCoords ?? fromCoords, () => false);\n  }\n\n  /** Toggles the selection state of one or more cells in a given range. */\n  toggle(fromCoords: RowCol, toCoords?: RowCol): void {\n    this._updateState(fromCoords, toCoords ?? fromCoords, oldState => !oldState);\n  }\n\n  /** Selects all valid cells in the grid. */\n  selectAll(): void {\n    this._updateState(\n      {row: 0, col: 0},\n      {row: this.inputs.grid.maxRowCount(), col: this.inputs.grid.maxColCount()},\n      () => true,\n    );\n  }\n\n  /** Deselects all valid cells in the grid. */\n  deselectAll(): void {\n    this._updateState(\n      {row: 0, col: 0},\n      {row: this.inputs.grid.maxRowCount(), col: this.inputs.grid.maxColCount()},\n      () => false,\n    );\n  }\n\n  /** Whether a cell is selctable. */\n  isSelectable(cell: T) {\n    return cell.selectable() && !cell.disabled();\n  }\n\n  /** A generator that yields all cells within a given range. */\n  *_validCells(fromCoords: RowCol, toCoords: RowCol): Generator<T> {\n    const startRow = Math.min(fromCoords.row, toCoords.row);\n    const startCol = Math.min(fromCoords.col, toCoords.col);\n    const endRow = Math.max(fromCoords.row, toCoords.row);\n    const endCol = Math.max(fromCoords.col, toCoords.col);\n    const visited = new Set<T>();\n    for (let row = startRow; row < endRow + 1; row++) {\n      for (let col = startCol; col < endCol + 1; col++) {\n        const cell = this.inputs.grid.getCell({row, col});\n        if (cell === undefined) continue;\n        if (!this.isSelectable(cell)) continue;\n        if (visited.has(cell)) continue;\n        visited.add(cell);\n        yield cell;\n      }\n    }\n  }\n\n  /**\n   * Updates the selection state of cells in a given range and preserves previous changes\n   * to a undo list.\n   */\n  private _updateState(\n    fromCoords: RowCol,\n    toCoords: RowCol,\n    stateFn: (oldState: boolean) => boolean,\n  ): void {\n    const undoList: [T, boolean][] = [];\n    for (const cell of this._validCells(fromCoords, toCoords)) {\n      const oldState = cell.selected();\n      undoList.push([cell, oldState]);\n      cell.selected.set(stateFn(oldState));\n    }\n    this._undoList.set(undoList);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {GridData, BaseGridCell, GridDataInputs, RowCol} from './grid-data';\nimport {GridFocus, GridFocusCell, GridFocusInputs} from './grid-focus';\nimport {\n  direction,\n  GridNavigation,\n  GridNavigationCell,\n  GridNavigationInputs,\n} from './grid-navigation';\nimport {GridSelectionCell, GridSelectionInputs, GridSelection} from './grid-selection';\nimport {computed, linkedSignal, signal, SignalLike} from '../signal-like/signal-like';\n\n/** The selection operations that can be performed after a navigation operation. */\nexport interface NavOptions {\n  /** Toggles the selection state of the active cell. */\n  toggle?: boolean;\n\n  /**\n   * Toggles the selection state of the active cell, and deselects all other cells if the\n   * active cell is selected. If the active cell is the only selected cell, it will be deselected.\n   */\n  toggleOne?: boolean;\n\n  /** Selects the active cell, preserving the selection state of other cells. */\n  select?: boolean;\n\n  /** Deselects all other cells and selects the active cell. */\n  selectOne?: boolean;\n\n  /**\n   * Moves the selection anchor to the active cell and updates the selection to include all\n   * cells between the anchor and the active cell.\n   */\n  anchor?: boolean;\n}\n\n/** A type that represents a cell in a grid, combining all cell-related interfaces. */\nexport type GridCell = BaseGridCell & GridFocusCell & GridNavigationCell & GridSelectionCell;\n\n/** Represents the required inputs for a grid. */\nexport type GridInputs<T extends GridCell> = GridDataInputs<T> &\n  GridFocusInputs &\n  GridNavigationInputs &\n  GridSelectionInputs;\n\n/** The main class that orchestrates the grid behaviors. */\nexport class Grid<T extends GridCell> {\n  /** The underlying data structure for the grid. */\n  readonly data: GridData<T>;\n\n  /** Controls focus for the grid. */\n  readonly focusBehavior: GridFocus<T>;\n\n  /** Controls navigation for the grid. */\n  readonly navigationBehavior: GridNavigation<T>;\n\n  /** Controls selection for the grid. */\n  readonly selectionBehavior: GridSelection<T>;\n\n  /** The anchor point for range selection, linked to the active coordinates. */\n  readonly selectionAnchor = linkedSignal<RowCol>(() => this.focusBehavior.activeCoords());\n\n  /** The cell at the selection anchor. */\n  readonly selectionAnchorCell = computed(() => this.data.getCell(this.selectionAnchor()));\n\n  /** Whether a range selection has settled. */\n  readonly selectionStabled = signal(true);\n\n  /** Whether all selectable cells are selected. */\n  readonly allSelected: SignalLike<boolean> = computed(() =>\n    this.data\n      .cells()\n      .flat()\n      .filter(c => this.selectionBehavior.isSelectable(c))\n      .every(c => c.selected()),\n  );\n\n  /** The tab index for the grid container. */\n  readonly gridTabIndex: SignalLike<-1 | 0> = () => this.focusBehavior.gridTabIndex();\n\n  /** Whether the grid is in a disabled state. */\n  readonly gridDisabled: SignalLike<boolean> = () => this.focusBehavior.gridDisabled();\n\n  /** The ID of the active descendant for ARIA `activedescendant` focus management. */\n  readonly activeDescendant: SignalLike<string | undefined> = () =>\n    this.focusBehavior.activeDescendant();\n\n  constructor(readonly inputs: GridInputs<T>) {\n    this.data = new GridData(inputs);\n    this.focusBehavior = new GridFocus({...inputs, grid: this.data});\n    this.navigationBehavior = new GridNavigation({\n      ...inputs,\n      grid: this.data,\n      gridFocus: this.focusBehavior,\n    });\n    this.selectionBehavior = new GridSelection({\n      ...inputs,\n      grid: this.data,\n      gridFocus: this.focusBehavior,\n    });\n  }\n\n  /** Gets the 1-based row index of a cell. */\n  rowIndex(cell: T): number | undefined {\n    const index = this.data.getCoords(cell)?.row;\n    return index !== undefined ? index + 1 : undefined;\n  }\n\n  /** Gets the 1-based column index of a cell. */\n  colIndex(cell: T): number | undefined {\n    const index = this.data.getCoords(cell)?.col;\n    return index !== undefined ? index + 1 : undefined;\n  }\n\n  /** Gets the tab index for a given cell. */\n  cellTabIndex(cell: T): -1 | 0 {\n    return this.focusBehavior.getCellTabIndex(cell);\n  }\n\n  /** Navigates to the cell above the currently active cell. */\n  up(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() =>\n              this.navigationBehavior.peek(direction.Up, this.selectionAnchor(), 'nowrap', true),\n            )\n          : this.navigationBehavior.advance(direction.Up),\n      opts,\n    );\n  }\n\n  /** Navigates to the cell below the currently active cell. */\n  down(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() =>\n              this.navigationBehavior.peek(direction.Down, this.selectionAnchor(), 'nowrap', true),\n            )\n          : this.navigationBehavior.advance(direction.Down),\n      opts,\n    );\n  }\n\n  /** Navigates to the cell to the left of the currently active cell. */\n  left(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() =>\n              this.navigationBehavior.peek(direction.Left, this.selectionAnchor(), 'nowrap', true),\n            )\n          : this.navigationBehavior.advance(direction.Left),\n      opts,\n    );\n  }\n\n  /** Navigates to the cell to the right of the currently active cell. */\n  right(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() =>\n              this.navigationBehavior.peek(direction.Right, this.selectionAnchor(), 'nowrap', true),\n            )\n          : this.navigationBehavior.advance(direction.Right),\n      opts,\n    );\n  }\n\n  /** Navigates to the first focusable cell in the grid. */\n  first(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() => this.navigationBehavior.peekFirst(undefined, true))\n          : this.navigationBehavior.first(),\n      opts,\n    );\n  }\n\n  /** Navigates to the first focusable cell in the current row. */\n  firstInRow(opts: NavOptions = {}): boolean {\n    const row = this.focusBehavior.activeCoords().row;\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() => this.navigationBehavior.peekFirst(row, true))\n          : this.navigationBehavior.first(row),\n      opts,\n    );\n  }\n\n  /** Navigates to the last focusable cell in the grid. */\n  last(opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() => this.navigationBehavior.peekLast(undefined, true))\n          : this.navigationBehavior.last(),\n      opts,\n    );\n  }\n\n  /** Navigates to the last focusable cell in the current row. */\n  lastInRow(opts: NavOptions = {}): boolean {\n    const row = this.focusBehavior.activeCoords().row;\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() => this.navigationBehavior.peekLast(row, true))\n          : this.navigationBehavior.last(row),\n      opts,\n    );\n  }\n\n  /** Selects all cells in the current row. */\n  selectRow(): void {\n    const row = this.focusBehavior.activeCoords().row;\n    this.selectionBehavior.deselectAll();\n    this.selectionBehavior.select({row, col: 0}, {row, col: this.data.maxColCount()});\n  }\n\n  /** Selects all cells in the current column. */\n  selectCol(): void {\n    const col = this.focusBehavior.activeCoords().col;\n    this.selectionBehavior.deselectAll();\n    this.selectionBehavior.select({row: 0, col}, {row: this.data.maxRowCount(), col});\n  }\n\n  /** Selects the active cell. */\n  select(): void {\n    this.selectionBehavior.select(this.focusBehavior.activeCoords());\n  }\n\n  /** Deselects the active cell. */\n  deselect(): void {\n    this.selectionBehavior.deselect(this.focusBehavior.activeCoords());\n  }\n\n  /**\n   * Toggles the selection state of the coordinates of the given cell\n   * or the current active coordinates.\n   */\n  toggle(): void {\n    this.selectionBehavior.toggle(this.focusBehavior.activeCoords());\n  }\n\n  /** Toggles the selection state of the active cell, and deselects all other cells. */\n  toggleOne(): void {\n    const selected = !!this.focusBehavior.activeCell()?.selected();\n    if (selected) {\n      this.deselect();\n      return;\n    }\n\n    this.deselectAll();\n    this.select();\n  }\n\n  /** Selects all selectable cells in the grid. */\n  selectAll(): void {\n    this.selectionBehavior.selectAll();\n  }\n\n  /** Deselects all cells in the grid. */\n  deselectAll(): void {\n    this.selectionBehavior.deselectAll();\n  }\n\n  /** Navigates to and focuses the given cell. */\n  gotoCell(cell: T, opts: NavOptions = {}): boolean {\n    return this._navigateWithSelection(\n      () =>\n        opts.anchor\n          ? this._updateSelectionAnchor(() => this.data.getCoords(cell))\n          : this.navigationBehavior.gotoCell(cell),\n      opts,\n    );\n  }\n\n  /** Sets the default active state of the grid. */\n  setDefaultState(): boolean {\n    // Try to find a selected cell that's focusable.\n    const focusableSelectedCell: T | undefined = this.data\n      .cells()\n      .flat()\n      .filter(c => this.focusBehavior.isFocusable(c))\n      .find(c => c.selected());\n\n    if (focusableSelectedCell !== undefined) {\n      this.focusBehavior.focusCell(focusableSelectedCell);\n      return true;\n    }\n\n    // Otherwise find the first focusable cell.\n    const firstFocusableCoords = this.navigationBehavior.peekFirst();\n\n    if (firstFocusableCoords !== undefined) {\n      return this.focusBehavior.focusCoordinates(firstFocusableCoords);\n    }\n\n    return false;\n  }\n\n  /** Resets the active state of the grid if it is empty or stale. */\n  resetState(): boolean {\n    if (this.focusBehavior.stateEmpty()) {\n      return this.setDefaultState();\n    }\n\n    if (this.focusBehavior.stateStale()) {\n      // Try focus on the same active cell after if a reordering happened.\n      if (this.focusBehavior.focusCell(this.focusBehavior.activeCell()!)) {\n        return true;\n      }\n\n      // If the active cell is no longer exist, focus on the coordinates instead.\n      if (this.focusBehavior.focusCoordinates(this.focusBehavior.activeCoords())) {\n        return true;\n      }\n\n      // If the coordinates no longer valid, go back to the first available cell.\n      if (this.focusBehavior.focusCoordinates(this.navigationBehavior.peekFirst()!)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /** Updates the selection anchor to the given coordinates. */\n  private _updateSelectionAnchor(peekFn: () => RowCol | undefined): boolean {\n    const coords = peekFn();\n    const success = coords !== undefined;\n    if (!success) return false;\n    this.selectionAnchor.set(coords);\n    return success;\n  }\n\n  /** Updates the selection to include all cells between the anchor and the active cell. */\n  private _updateRangeSelection(): void {\n    if (!this.selectionStabled()) {\n      this.selectionBehavior.undo();\n    }\n    this.selectionBehavior.select(\n      ...this._getSelectionCoords(this.focusBehavior.activeCoords(), this.selectionAnchor()),\n    );\n  }\n\n  /** Gets the start and end coordinates for a selection range. */\n  private _getSelectionCoords(startCoords: RowCol, endCoords: RowCol): [RowCol, RowCol] {\n    const startCell = this.data.getCell(startCoords)!;\n    const endCell = this.data.getCell(endCoords)!;\n    const allCoords = [...this.data.getAllCoords(startCell)!, ...this.data.getAllCoords(endCell)!];\n    const allRows = allCoords.map(c => c.row);\n    const allCols = allCoords.map(c => c.col);\n    const fromCoords = {\n      row: Math.min(...allRows),\n      col: Math.min(...allCols),\n    };\n    const toCoords = {\n      row: Math.max(...allRows),\n      col: Math.max(...allCols),\n    };\n\n    return [fromCoords, toCoords];\n  }\n\n  /** Executes a navigation operation and applies selection options. */\n  private _navigateWithSelection(op: () => boolean, opts: NavOptions = {}): boolean {\n    const success = op();\n    if (!success) return false;\n\n    if (opts.anchor) {\n      this._updateRangeSelection();\n      this.selectionStabled.set(false);\n      return success;\n    }\n\n    // Selection becomes stable after the active cell/coords moved.\n    this.selectionStabled.set(true);\n\n    if (opts.select) {\n      this.select();\n      return success;\n    }\n\n    if (opts.selectOne) {\n      this.deselectAll();\n      this.select();\n      return success;\n    }\n\n    if (opts.toggle) {\n      this.toggle();\n      return success;\n    }\n\n    if (opts.toggleOne) {\n      const selected = !!this.focusBehavior.activeCell()?.selected();\n      this.deselectAll();\n      if (!selected) {\n        this.select();\n      }\n      return success;\n    }\n\n    return success;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {SignalLike, computed, signal, untracked} from '../behaviors/signal-like/signal-like';\nimport {KeyboardEventManager, PointerEventManager, Modifier} from '../behaviors/event-manager';\nimport {NavOptions, Grid, GridInputs as GridBehaviorInputs} from '../behaviors/grid';\nimport type {GridRowPattern} from './row';\nimport type {GridCellPattern} from './cell';\n\n/** Represents the required inputs for the grid pattern. */\nexport interface GridInputs extends Omit<GridBehaviorInputs<GridCellPattern>, 'cells'> {\n  /** The html element of the grid. */\n  element: SignalLike<HTMLElement>;\n\n  /** The rows that make up the grid. */\n  rows: SignalLike<GridRowPattern[]>;\n\n  /** The direction that text is read based on the users locale. */\n  textDirection: SignalLike<'rtl' | 'ltr'>;\n\n  /** Whether selection is enabled for the grid. */\n  enableSelection: SignalLike<boolean>;\n\n  /** Whether multiple cell in the grid can be selected. */\n  multi: SignalLike<boolean>;\n\n  /** The selection strategy used by the grid. */\n  selectionMode: SignalLike<'follow' | 'explicit'>;\n\n  /** Whether enable range selection. */\n  enableRangeSelection: SignalLike<boolean>;\n\n  /** A function that returns the grid cell associated with a given element. */\n  getCell: (e: Element | null) => GridCellPattern | undefined;\n}\n\n/** The UI pattern for a grid, handling keyboard navigation, focus, and selection. */\nexport class GridPattern {\n  /** The underlying grid behavior that this pattern is built on. */\n  readonly gridBehavior: Grid<GridCellPattern>;\n\n  /** The cells in the grid. */\n  readonly cells = computed(() => this.gridBehavior.data.cells());\n\n  /** The tab index for the grid. */\n  readonly tabIndex = computed(() => this.gridBehavior.gridTabIndex());\n\n  /** Whether the grid is disabled. */\n  readonly disabled = computed(() => this.gridBehavior.gridDisabled());\n\n  /** The ID of the currently active descendant cell. */\n  readonly activeDescendant = computed(() => this.gridBehavior.activeDescendant());\n\n  /** The currently active cell. */\n  readonly activeCell = computed(() => this.gridBehavior.focusBehavior.activeCell());\n\n  /** The current selection anchor cell. */\n  readonly anchorCell: SignalLike<GridCellPattern | undefined> = computed(() =>\n    this.inputs.enableSelection() && this.inputs.multi()\n      ? this.gridBehavior.selectionAnchorCell()\n      : undefined,\n  );\n\n  /** Whether to pause grid navigation and give the keyboard control to cell or widget. */\n  readonly pauseNavigation: SignalLike<boolean> = computed(() =>\n    this.gridBehavior.data\n      .cells()\n      .flat()\n      .reduce((res, c) => res || c.isActivated(), false),\n  );\n\n  /** Whether the focus is in the grid. */\n  readonly isFocused = signal(false);\n\n  /** Whether the grid has been focused once. */\n  readonly hasBeenFocused = signal(false);\n\n  /** Whether the user is currently dragging to select a range of cells. */\n  readonly dragging = signal(false);\n\n  /** The key for navigating to the previous column. */\n  readonly prevColKey = computed(() =>\n    this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft',\n  );\n\n  /** The key for navigating to the next column. */\n  readonly nextColKey = computed(() =>\n    this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight',\n  );\n\n  /** Whether the grid pattern is currently accepting `pointermove` events. */\n  readonly acceptsPointerMove = computed(() => {\n    return (\n      !this.disabled() &&\n      this.inputs.enableSelection() &&\n      this.inputs.enableRangeSelection() &&\n      this.dragging()\n    );\n  });\n\n  /** The keydown event manager for the grid. */\n  readonly keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n\n    if (this.pauseNavigation()) {\n      return manager;\n    }\n\n    // Navigation handlers.\n    const opts: NavOptions = {\n      selectOne: this.inputs.enableSelection() && this.inputs.selectionMode() === 'follow',\n    };\n    manager\n      .on('ArrowUp', () => this.gridBehavior.up(opts))\n      .on('ArrowDown', () => this.gridBehavior.down(opts))\n      .on(this.prevColKey(), () => this.gridBehavior.left(opts))\n      .on(this.nextColKey(), () => this.gridBehavior.right(opts))\n      .on('Home', () => this.gridBehavior.firstInRow(opts))\n      .on('End', () => this.gridBehavior.lastInRow(opts))\n      .on([Modifier.Ctrl], 'Home', () => this.gridBehavior.first(opts))\n      .on([Modifier.Ctrl], 'End', () => this.gridBehavior.last(opts));\n\n    // Basic explicit selection handlers.\n    if (this.inputs.enableSelection() && this.inputs.selectionMode() === 'explicit') {\n      manager.on(/Enter| /, () =>\n        this.inputs.multi() ? this.gridBehavior.toggle() : this.gridBehavior.toggleOne(),\n      );\n    }\n\n    // Range selection handlers.\n    if (this.inputs.enableSelection() && this.inputs.enableRangeSelection()) {\n      manager\n        .on(Modifier.Shift, 'ArrowUp', () => this.gridBehavior.up({anchor: true}))\n        .on(Modifier.Shift, 'ArrowDown', () => this.gridBehavior.down({anchor: true}))\n        .on(Modifier.Shift, this.prevColKey(), () => this.gridBehavior.left({anchor: true}))\n        .on(Modifier.Shift, this.nextColKey(), () => this.gridBehavior.right({anchor: true}))\n        .on(Modifier.Shift, 'Home', () => this.gridBehavior.firstInRow({anchor: true}))\n        .on(Modifier.Shift, 'End', () => this.gridBehavior.lastInRow({anchor: true}))\n        .on([Modifier.Ctrl | Modifier.Shift], 'Home', () => this.gridBehavior.first({anchor: true}))\n        .on([Modifier.Ctrl | Modifier.Shift], 'End', () => this.gridBehavior.last({anchor: true}))\n        .on([Modifier.Ctrl, Modifier.Meta], 'A', () => {\n          if (this.gridBehavior.allSelected()) {\n            this.gridBehavior.deselectAll();\n          } else {\n            this.gridBehavior.selectAll();\n          }\n        })\n        .on([Modifier.Shift], ' ', () => this.gridBehavior.selectRow())\n        .on([Modifier.Ctrl, Modifier.Meta], ' ', () => this.gridBehavior.selectCol());\n    }\n\n    return manager;\n  });\n\n  /** The pointerdown event manager for the grid. */\n  readonly pointerdown = computed(() => {\n    const manager = new PointerEventManager();\n\n    // Navigation without selection.\n    if (!this.inputs.enableSelection()) {\n      manager.on(e => {\n        const cell = this.inputs.getCell(e.target as Element);\n        if (!cell || !this.gridBehavior.focusBehavior.isFocusable(cell)) return;\n\n        this.gridBehavior.gotoCell(cell);\n      });\n    }\n\n    // Navigation with selection.\n    if (this.inputs.enableSelection()) {\n      manager.on(e => {\n        const cell = this.inputs.getCell(e.target as Element);\n        if (!cell || !this.gridBehavior.focusBehavior.isFocusable(cell)) return;\n\n        this.gridBehavior.gotoCell(cell, {\n          selectOne: this.inputs.selectionMode() === 'follow',\n          toggleOne: this.inputs.selectionMode() === 'explicit' && !this.inputs.multi(),\n          toggle: this.inputs.selectionMode() === 'explicit' && this.inputs.multi(),\n        });\n\n        if (this.inputs.multi() && this.inputs.enableRangeSelection()) {\n          this.dragging.set(true);\n        }\n      });\n\n      // Selection with modifier keys.\n      if (this.inputs.multi()) {\n        manager.on([Modifier.Ctrl, Modifier.Meta], e => {\n          const cell = this.inputs.getCell(e.target as Element);\n          if (!cell || !this.gridBehavior.focusBehavior.isFocusable(cell)) return;\n\n          this.gridBehavior.gotoCell(cell, {toggle: true});\n\n          if (this.inputs.enableRangeSelection()) {\n            this.dragging.set(true);\n          }\n        });\n\n        if (this.inputs.enableRangeSelection()) {\n          manager.on(Modifier.Shift, e => {\n            const cell = this.inputs.getCell(e.target as Element);\n            if (!cell) return;\n\n            this.gridBehavior.gotoCell(cell, {anchor: true});\n            this.dragging.set(true);\n          });\n        }\n      }\n    }\n\n    return manager;\n  });\n\n  /** The pointerup event manager for the grid. */\n  readonly pointerup = computed(() => {\n    const manager = new PointerEventManager();\n\n    if (this.inputs.enableSelection() && this.inputs.enableRangeSelection()) {\n      manager.on([Modifier.Shift, Modifier.Ctrl, Modifier.Meta, Modifier.None], () => {\n        this.dragging.set(false);\n      });\n    }\n\n    return manager;\n  });\n\n  /** Indicates maybe the losing focus is caused by row/cell deletion. */\n  private readonly _maybeDeletion = signal(false);\n\n  /** Indicates the losing focus is certainly caused by row/cell deletion. */\n  private readonly _deletion = signal(false);\n\n  /** Whether the grid state is stale and needs to be reconciled. */\n  private readonly _stateStale = signal(false);\n\n  constructor(readonly inputs: GridInputs) {\n    this.gridBehavior = new Grid({\n      ...inputs,\n      cells: computed(() => this.inputs.rows().map(row => row.inputs.cells())),\n    });\n  }\n\n  /** Handles keydown events on the grid. */\n  onKeydown(event: KeyboardEvent) {\n    if (this.disabled()) return;\n\n    this.activeCell()?.onKeydown(event);\n    this.keydown().handle(event);\n  }\n\n  /** Handles pointerdown events on the grid. */\n  onPointerdown(event: PointerEvent) {\n    if (this.disabled()) return;\n\n    this.pointerdown().handle(event);\n  }\n\n  /** Handles pointermove events on the grid. */\n  onPointermove(event: PointerEvent) {\n    if (this.acceptsPointerMove()) {\n      const cell = this.inputs.getCell(event.target as Element);\n\n      // Dragging anchor.\n      if (cell !== undefined) {\n        this.gridBehavior.gotoCell(cell, {anchor: true});\n      }\n    }\n  }\n\n  /** Handles pointerup events on the grid. */\n  onPointerup(event: PointerEvent) {\n    if (this.disabled()) return;\n\n    this.pointerup().handle(event);\n  }\n\n  /** Handles focusin events on the grid. */\n  onFocusIn(event: FocusEvent) {\n    this.isFocused.set(true);\n    this.hasBeenFocused.set(true);\n\n    // Skip if in the middle of range selection.\n    if (this.dragging()) return;\n\n    // Cell that receives focus.\n    const cell = this.inputs.getCell(event.target as Element | null);\n    if (!cell || !this.gridBehavior.focusBehavior.isFocusable(cell)) return;\n\n    // Pass down the focusin event to the cell.\n    cell.onFocusIn(event);\n\n    // Update active cell state if the cell is receiving focus by\n    // tabbing, pointer, or any programmatic control into a widget inside the cell.\n    if (cell !== this.activeCell()) {\n      this.gridBehavior.gotoCell(cell);\n    }\n  }\n\n  /** Handles focusout events on the grid. */\n  onFocusOut(event: FocusEvent) {\n    // Pass down focusout event to the cell that loses focus.\n    const blurTarget = event.target as Element | null;\n    const cell = this.inputs.getCell(blurTarget);\n\n    // Pass down the focusout event to the cell.\n    cell?.onFocusOut(event);\n\n    const focusTarget = event.relatedTarget as Element | null;\n    if (this.inputs.element().contains(focusTarget)) return;\n\n    // If a `relatedTarget`(focusing target) is null, then it can be caused by either\n    // - Clicking on a non-focusable element, or\n    // - The focused element is removed from the page.\n    if (focusTarget === null) {\n      this._maybeDeletion.set(true);\n    }\n\n    this.isFocused.set(false);\n  }\n\n  /** Sets the default active state of the grid before receiving focus the first time. */\n  setDefaultStateEffect(): void {\n    if (this.hasBeenFocused()) return;\n\n    this.gridBehavior.setDefaultState();\n  }\n\n  /** Resets the active state of the grid if it is empty or stale. */\n  resetStateEffect(): void {\n    const hasReset = this.gridBehavior.resetState();\n\n    if (hasReset) {\n      // If the active state has been reset right after a focusout event, then\n      // we know it's caused by a row/cell deletion.\n      if (this._maybeDeletion()) {\n        this._deletion.set(true);\n      } else {\n        this._stateStale.set(true);\n      }\n    }\n    // Reset maybe deletion state.\n    this._maybeDeletion.set(false);\n  }\n\n  /** Resets the focus to the active cell element or grid element. */\n  resetFocusEffect(): void {\n    const stateStale = this._stateStale();\n    if (!stateStale) return;\n\n    const isFocused = untracked(() => this.isFocused());\n    const isRoving = untracked(() => this.inputs.focusMode() === 'roving');\n    const activeCell = untracked(() => this.activeCell());\n\n    if (isRoving && activeCell !== undefined && isFocused) {\n      if (!activeCell.isFocused()) {\n        activeCell.focus();\n      }\n    }\n\n    this._stateStale.set(false);\n  }\n\n  /** Restore focus when a deletion happened. */\n  restoreFocusEffect(): void {\n    const deletion = this._deletion();\n    if (!deletion) return;\n\n    const isRoving = untracked(() => this.inputs.focusMode() === 'roving');\n    const activeCell = untracked(() => this.activeCell());\n\n    if (isRoving && activeCell !== undefined) {\n      if (!activeCell.isFocused()) {\n        activeCell.focus();\n      }\n    }\n\n    this._deletion.set(false);\n  }\n\n  /** Sets focus when active cell changed. */\n  focusEffect(): void {\n    const activeCell = this.activeCell();\n    const gridFocused = untracked(() => this.isFocused());\n\n    if (activeCell === undefined || !gridFocused) return;\n\n    const isRoving = untracked(() => this.inputs.focusMode() === 'roving');\n    const cellFocused = untracked(() => activeCell.isFocused());\n\n    if (isRoving && !cellFocused) {\n      activeCell.focus();\n    }\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport type {GridPattern} from './grid';\nimport type {GridCellPattern} from './cell';\n\n/** The inputs for the `GridRowPattern`. */\nexport interface GridRowInputs {\n  /** The `GridPattern` that this row belongs to. */\n  grid: SignalLike<GridPattern>;\n\n  /** The cells that make up this row. */\n  cells: SignalLike<GridCellPattern[]>;\n\n  /** The index of this row within the grid. */\n  rowIndex: SignalLike<number | undefined>;\n}\n\n/** The UI pattern for a grid row. */\nexport class GridRowPattern {\n  /** The index of this row within the grid. */\n  rowIndex: SignalLike<number | undefined>;\n\n  constructor(readonly inputs: GridRowInputs) {\n    this.rowIndex = inputs.rowIndex;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {KeyboardEventManager} from '../behaviors/event-manager';\nimport {ListFocus} from '../behaviors/list-focus/list-focus';\nimport {ListNavigation, ListNavigationInputs} from '../behaviors/list-navigation/list-navigation';\nimport {\n  computed,\n  signal,\n  linkedSignal,\n  SignalLike,\n  WritableSignalLike,\n} from '../behaviors/signal-like/signal-like';\nimport {GridCell} from '../behaviors/grid';\nimport type {GridPattern} from './grid';\nimport type {GridRowPattern} from './row';\nimport {GridCellWidgetPattern} from './widget';\n\n/** The inputs for the `GridCellPattern`. */\nexport interface GridCellInputs\n  extends\n    GridCell,\n    Omit<\n      ListNavigationInputs<GridCellWidgetPattern>,\n      'focusMode' | 'items' | 'activeItem' | 'softDisabled' | 'element'\n    > {\n  /** The `GridPattern` that this cell belongs to. */\n  grid: SignalLike<GridPattern>;\n\n  /** The `GridRowPattern` that this cell belongs to. */\n  row: SignalLike<GridRowPattern>;\n\n  /** The widget patterns contained within this cell, if any. */\n  widgets: SignalLike<GridCellWidgetPattern[]>;\n\n  /** The index of this cell's row within the grid. */\n  rowIndex: SignalLike<number | undefined>;\n\n  /** The index of this cell's column within the grid. */\n  colIndex: SignalLike<number | undefined>;\n\n  /** A function that returns the cell widget associated with a given element. */\n  getWidget: (e: Element | null) => GridCellWidgetPattern | undefined;\n}\n\n/** The UI pattern for a grid cell. */\nexport class GridCellPattern implements GridCell {\n  /** A unique identifier for the cell. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The html element that should receive focus. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element();\n\n  /** Whether the cell has focus. */\n  readonly isFocused: WritableSignalLike<boolean> = signal(false);\n\n  /** Whether the cell is selected. */\n  readonly selected: WritableSignalLike<boolean>;\n\n  /** Whether the cell is selectable. */\n  readonly selectable: SignalLike<boolean> = () => this.inputs.selectable();\n\n  /** Whether a cell is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The number of rows the cell should span. */\n  readonly rowSpan: SignalLike<number> = () => this.inputs.rowSpan();\n\n  /** The number of columns the cell should span. */\n  readonly colSpan: SignalLike<number> = () => this.inputs.colSpan();\n\n  /** Whether the cell is active. */\n  readonly active: SignalLike<boolean> = computed(() => this.inputs.grid().activeCell() === this);\n\n  /** Whether the cell is a selection anchor. */\n  readonly anchor: SignalLike<true | undefined> = computed(() =>\n    this.inputs.grid().anchorCell() === this ? true : undefined,\n  );\n\n  /** The `aria-selected` attribute for the cell. */\n  readonly ariaSelected: SignalLike<boolean | undefined> = computed(() =>\n    this.inputs.grid().inputs.enableSelection() && this.selectable() ? this.selected() : undefined,\n  );\n\n  /** The `aria-rowindex` attribute for the cell. */\n  readonly ariaRowIndex: SignalLike<number | undefined> = computed(\n    () =>\n      this.inputs.row().rowIndex() ??\n      this.inputs.rowIndex() ??\n      this.inputs.grid().gridBehavior.rowIndex(this),\n  );\n\n  /** The `aria-colindex` attribute for the cell. */\n  readonly ariaColIndex: SignalLike<number | undefined> = computed(\n    () => this.inputs.colIndex() ?? this.inputs.grid().gridBehavior.colIndex(this),\n  );\n\n  /** The internal tab index calculation for the cell. */\n  private readonly _tabIndex: SignalLike<-1 | 0> = computed(() =>\n    this.inputs.grid().gridBehavior.cellTabIndex(this),\n  );\n\n  /** The tab index for the cell. If the cell contains a widget, the cell's tab index is -1. */\n  readonly tabIndex: SignalLike<-1 | 0> = computed(() => {\n    if (this.singleWidgetMode() || this.navigationActivated()) {\n      return -1;\n    }\n    return this._tabIndex();\n  });\n\n  // Single/Multi Widget Navigation Setup\n\n  /** Whether the cell contains a single widget. */\n  readonly singleWidgetMode: SignalLike<boolean> = computed(\n    () => this.inputs.widgets().length === 1,\n  );\n\n  /** Whether the cell contains multiple widgets. */\n  readonly multiWidgetMode: SignalLike<boolean> = computed(() => this.inputs.widgets().length > 1);\n\n  /** Whether navigation between widgets is disabled. */\n  readonly navigationDisabled: SignalLike<boolean> = computed(\n    () => !this.multiWidgetMode() || !this.active() || this.inputs.disabled(),\n  );\n\n  /** The focus behavior for the widgets in the cell. */\n  readonly focusBehavior: ListFocus<GridCellWidgetPattern>;\n\n  /** The navigation behavior for the widgets in the cell. */\n  readonly navigationBehavior: ListNavigation<GridCellWidgetPattern>;\n\n  /** The currently active widget in the cell. */\n  readonly activeWidget: WritableSignalLike<GridCellWidgetPattern | undefined> = linkedSignal(() =>\n    this.inputs.widgets().length > 0 ? this.inputs.widgets()[0] : undefined,\n  );\n\n  /** Whether navigation between widgets is activated. */\n  readonly navigationActivated: WritableSignalLike<boolean> = signal(false);\n\n  /** Whether any widget within the cell is activated. */\n  readonly widgetActivated: SignalLike<boolean> = computed(() =>\n    this.inputs.widgets().some(w => w.isActivated()),\n  );\n\n  /** Whether the cell or widget inside the cell is activated. */\n  readonly isActivated: SignalLike<boolean> = computed(\n    () => this.navigationActivated() || this.widgetActivated(),\n  );\n\n  /** The key used to navigate to the previous widget. */\n  readonly prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key used to navigate to the next widget. */\n  readonly nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The keyboard event manager for the cell. */\n  readonly keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n\n    // Before start list navigation.\n    if (!this.navigationActivated()) {\n      manager.on('Enter', () => this.startNavigation());\n      return manager;\n    }\n\n    // Start list navigation.\n    manager\n      .on('Escape', () => this.stopNavigation())\n      .on(this.prevKey(), () =>\n        this._advance(() => this.navigationBehavior.prev({focusElement: false})),\n      )\n      .on(this.nextKey(), () =>\n        this._advance(() => this.navigationBehavior.next({focusElement: false})),\n      )\n      .on('Home', () => this._advance(() => this.navigationBehavior.next({focusElement: false})))\n      .on('End', () => this._advance(() => this.navigationBehavior.next({focusElement: false})));\n\n    return manager;\n  });\n\n  constructor(readonly inputs: GridCellInputs) {\n    this.selected = inputs.selected;\n\n    const listNavigationInputs: ListNavigationInputs<GridCellWidgetPattern> = {\n      ...inputs,\n      items: inputs.widgets,\n      activeItem: this.activeWidget,\n      disabled: this.navigationDisabled,\n      focusMode: () => 'roving',\n      softDisabled: () => true,\n    };\n\n    this.focusBehavior = new ListFocus<GridCellWidgetPattern>(listNavigationInputs);\n    this.navigationBehavior = new ListNavigation<GridCellWidgetPattern>({\n      ...listNavigationInputs,\n      focusManager: this.focusBehavior,\n    });\n  }\n\n  /** Handles keydown events for the cell. */\n  onKeydown(event: KeyboardEvent): void {\n    if (this.disabled() || this.inputs.widgets().length === 0) return;\n\n    // No navigation needed if single widget.\n    if (this.singleWidgetMode()) {\n      this.activeWidget()!.onKeydown(event);\n      return;\n    }\n\n    // Focus is on the cell before the navigation starts.\n    if (!this.navigationActivated()) {\n      this.keydown().handle(event);\n      return;\n    }\n\n    // Widget activate state can be changed during the widget keydown handling.\n    const widgetActivated = this.widgetActivated();\n\n    this.activeWidget()!.onKeydown(event);\n\n    if (!widgetActivated) {\n      this.keydown().handle(event);\n    }\n  }\n\n  /** Handles focusin events for the cell. */\n  onFocusIn(event: FocusEvent): void {\n    this.isFocused.set(true);\n\n    const focusTarget = event.target as Element | null;\n    const widget = this.inputs.getWidget(focusTarget);\n    if (!widget) return;\n\n    // Pass down focusin event to the widget.\n    widget.onFocusIn(event);\n\n    // Update internal states if the widget(or anything within the widget) is\n    // receiving focus by tabbing, pointer, or any programmatic control.\n\n    // Update current active widget.\n    if (widget !== this.activeWidget()) {\n      this.navigationBehavior.goto(widget, {focusElement: false});\n    }\n\n    // Start widget navigation if multi widget.\n    if (this.multiWidgetMode()) {\n      this.navigationActivated.set(true);\n    }\n  }\n\n  /** Handles focusout events for the cell. */\n  onFocusOut(event: FocusEvent): void {\n    const blurTarget = event.target as Element | null;\n    const widget = this.inputs.getWidget(blurTarget);\n\n    // Pass down focusout event to the widget.\n    widget?.onFocusOut(event);\n\n    const focusTarget = event.relatedTarget as Element | null;\n    if (this.element().contains(focusTarget)) return;\n\n    this.isFocused.set(false);\n    // Reset navigation state when focus leaving cell.\n    this.navigationActivated.set(false);\n  }\n\n  /** Focuses the cell or the active widget. */\n  focus(): void {\n    if (this.singleWidgetMode()) {\n      this.activeWidget()?.focus();\n    } else {\n      this.element().focus();\n    }\n  }\n\n  /** Gets the tab index for the widget within the cell. */\n  widgetTabIndex(): -1 | 0 {\n    if (this.singleWidgetMode()) {\n      return this._tabIndex();\n    }\n    return this.navigationActivated() ? 0 : -1;\n  }\n\n  /** Starts navigation between widgets. */\n  startNavigation(): void {\n    if (this.navigationActivated()) return;\n\n    this.navigationActivated.set(true);\n    this.navigationBehavior.first();\n  }\n\n  /** Stops navigation between widgets and restores focus to the cell. */\n  stopNavigation(): void {\n    if (!this.navigationActivated()) return;\n\n    this.navigationActivated.set(false);\n    this.element().focus();\n  }\n\n  /** Executes a navigation operation and focuses the new active widget. */\n  private _advance(op: () => boolean): void {\n    const success = op();\n    if (success) {\n      this.activeWidget()?.focus();\n    }\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {KeyboardEventManager, Modifier} from '../behaviors/event-manager';\nimport {ListNavigationItem} from '../behaviors/list-navigation/list-navigation';\nimport {\n  SignalLike,\n  computed,\n  signal,\n  WritableSignalLike,\n} from '../behaviors/signal-like/signal-like';\nimport type {GridCellPattern} from './cell';\n\n/** The inputs for the `GridCellWidgetPattern`. */\nexport interface GridCellWidgetInputs extends Omit<ListNavigationItem, 'index'> {\n  /** The `GridCellPattern` that this widget belongs to. */\n  cell: SignalLike<GridCellPattern>;\n\n  /** The html element that should receive focus. */\n  element: SignalLike<HTMLElement>;\n\n  /** The type of widget, which determines how it is activated. */\n  widgetType: SignalLike<'simple' | 'complex' | 'editable'>;\n\n  /** The element that will receive focus when the widget is activated. */\n  focusTarget: SignalLike<HTMLElement | undefined>;\n}\n\n/** The UI pattern for a widget inside a grid cell. */\nexport class GridCellWidgetPattern implements ListNavigationItem {\n  /** A unique identifier for the widget. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The html element that should receive focus. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element();\n\n  /** The element that should receive focus. */\n  readonly widgetHost: SignalLike<HTMLElement> = computed(\n    () => this.inputs.focusTarget() ?? this.element(),\n  );\n\n  /** The index of the widget within the cell. */\n  readonly index: SignalLike<number> = computed(() =>\n    this.inputs.cell().inputs.widgets().indexOf(this),\n  );\n\n  /** Whether the widget is disabled. */\n  readonly disabled: SignalLike<boolean> = computed(\n    () => this.inputs.disabled() || this.inputs.cell().disabled(),\n  );\n\n  /** The tab index for the widget. */\n  readonly tabIndex: SignalLike<-1 | 0> = computed(() => this.inputs.cell().widgetTabIndex());\n\n  /** Whether the widget is the active item in the widget list. */\n  readonly active: SignalLike<boolean> = computed(() => this.inputs.cell().activeWidget() === this);\n\n  /** Whether the widget is currently activated. */\n  readonly isActivated: WritableSignalLike<boolean> = signal(false);\n\n  /** The last event that caused the widget to be activated. */\n  readonly lastActivateEvent: WritableSignalLike<KeyboardEvent | FocusEvent | undefined> =\n    signal(undefined);\n\n  /** The last event that caused the widget to be deactivated. */\n  readonly lastDeactivateEvent: WritableSignalLike<KeyboardEvent | FocusEvent | undefined> =\n    signal(undefined);\n\n  /** The keyboard event manager for the widget. */\n  readonly keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n\n    // Simple widget does not need to pause default grid behaviors.\n    if (this.inputs.widgetType() === 'simple') {\n      return manager;\n    }\n\n    // If a widget is activated, only listen to events that exits activate state.\n    if (this.isActivated()) {\n      manager.on('Escape', e => {\n        this.deactivate(e);\n        this.focus();\n      });\n\n      if (this.inputs.widgetType() === 'editable') {\n        manager.on('Enter', e => {\n          this.deactivate(e);\n          this.focus();\n        });\n      }\n\n      return manager;\n    }\n\n    // Enter key is used to activate widget for both complex and editable type.\n    manager.on('Enter', e => this.activate(e));\n\n    if (this.inputs.widgetType() === 'editable') {\n      manager.on([Modifier.Shift, Modifier.None], /^[a-zA-Z0-9]$/, e => this.activate(e), {\n        preventDefault: false,\n      });\n    }\n\n    return manager;\n  });\n\n  constructor(readonly inputs: GridCellWidgetInputs) {}\n\n  /** Handles keydown events for the widget. */\n  onKeydown(event: KeyboardEvent): void {\n    if (this.disabled()) return;\n\n    this.keydown().handle(event);\n  }\n\n  /** Handles focusin events for the widget. */\n  onFocusIn(event: FocusEvent): void {\n    // Simple widget does not have activate state.\n    if (this.inputs.widgetType() === 'simple') return;\n\n    // Set activate state if the focus is inside of widget.\n    const focusTarget = event.target as Element;\n    if (this.widgetHost().contains(focusTarget) && this.widgetHost() !== focusTarget) {\n      this.activate(event);\n    }\n  }\n\n  /** Handles focusout events for the widget. */\n  onFocusOut(event: FocusEvent): void {\n    const focusTarget = event.relatedTarget as Element;\n    if (this.widgetHost().contains(focusTarget)) return;\n\n    // Reset states when focus leaving widget.\n    this.deactivate(event);\n  }\n\n  /** Focuses the widget's host element. */\n  focus(): void {\n    this.widgetHost().focus();\n  }\n\n  /** Activates the widget. */\n  activate(event?: KeyboardEvent | FocusEvent): void {\n    if (this.isActivated()) return;\n    if (this.inputs.widgetType() === 'simple') return;\n\n    this.isActivated.set(true);\n    this.lastActivateEvent.set(event);\n  }\n\n  /** Deactivates the widget and restores focus to the widget's host element. */\n  deactivate(event?: KeyboardEvent | FocusEvent): void {\n    if (!this.isActivated()) return;\n\n    this.isActivated.set(false);\n    this.lastDeactivateEvent.set(event);\n  }\n}\n"],"names":["GridData","inputs","cells","maxRowCount","computed","Math","max","_rowCountByCol","values","maxColCount","_colCountsByRow","_coordsMap","coordsMap","Map","visitedCoords","Set","rowIndex","length","colIndex","row","cell","has","rowspan","rowSpan","colspan","colSpan","spanCoords","rowOffset","colOffset","col","add","push","set","coords","_cellMap","cellMap","entries","colCountByRow","_","colCount","get","newColCount","undefined","rowCountByCol","rowCount","newRowCount","constructor","hasCell","getCell","rowCol","getCoords","getAllCoords","getRowCount","getColCount","GridFocus","activeCell","signal","activeCoords","stateEmpty","stateStale","activeCellCoords","grid","activeCoordsCell","activeCellNotValid","activeCellMismatch","activeDescendant","gridDisabled","focusMode","currentActiveCell","id","disabled","gridCells","every","gridTabIndex","getCellTabIndex","isFocusable","softDisabled","focusCell","focusCoordinates","direction","Up","Down","Left","Right","GridNavigation","_maxSteps","gotoCell","gridFocus","gotoCoords","peek","fromCoords","wrap","allowDisabled","rowWrap","colWrap","_peekDirectional","advance","nextCoords","peekFirst","first","peekLast","last","delta","fromCell","rowDelta","colDelta","step","isWrapping","generalDelta","rowStep","colStep","bothWrapping","nextCell","GridSelection","_undoList","undo","oldState","selected","select","toCoords","_updateState","deselect","toggle","selectAll","deselectAll","isSelectable","selectable","_validCells","startRow","min","startCol","endRow","endCol","visited","stateFn","undoList","Grid","data","focusBehavior","navigationBehavior","selectionBehavior","selectionAnchor","linkedSignal","selectionAnchorCell","selectionStabled","allSelected","flat","filter","c","index","cellTabIndex","up","opts","_navigateWithSelection","anchor","_updateSelectionAnchor","down","left","right","firstInRow","lastInRow","selectRow","selectCol","toggleOne","setDefaultState","focusableSelectedCell","find","firstFocusableCoords","resetState","peekFn","success","_updateRangeSelection","_getSelectionCoords","startCoords","endCoords","startCell","endCell","allCoords","allRows","map","allCols","op","selectOne","GridPattern","gridBehavior","tabIndex","anchorCell","enableSelection","multi","pauseNavigation","reduce","res","isActivated","isFocused","hasBeenFocused","dragging","prevColKey","textDirection","nextColKey","acceptsPointerMove","enableRangeSelection","keydown","manager","KeyboardEventManager","selectionMode","on","Modifier","Ctrl","Shift","Meta","pointerdown","PointerEventManager","e","target","pointerup","None","_maybeDeletion","_deletion","_stateStale","rows","onKeydown","event","handle","onPointerdown","onPointermove","onPointerup","onFocusIn","onFocusOut","blurTarget","focusTarget","relatedTarget","element","contains","setDefaultStateEffect","resetStateEffect","hasReset","resetFocusEffect","untracked","isRoving","focus","restoreFocusEffect","deletion","focusEffect","gridFocused","cellFocused","GridRowPattern","GridCellPattern","active","ariaSelected","ariaRowIndex","ariaColIndex","_tabIndex","singleWidgetMode","navigationActivated","widgets","multiWidgetMode","navigationDisabled","activeWidget","widgetActivated","some","w","prevKey","orientation","nextKey","startNavigation","stopNavigation","_advance","prev","focusElement","next","listNavigationInputs","items","activeItem","ListFocus","ListNavigation","focusManager","widget","getWidget","goto","widgetTabIndex","GridCellWidgetPattern","widgetHost","indexOf","lastActivateEvent","lastDeactivateEvent","widgetType","deactivate","activate","preventDefault"],"mappings":"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"}