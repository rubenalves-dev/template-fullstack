{"version":3,"file":"_signal-like-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/event-manager/event-manager.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/event-manager/keyboard-event-manager.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/signal-like/signal-like.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\n/**\n * An event that supports modifier keys.\n *\n * Matches the native KeyboardEvent, MouseEvent, and TouchEvent.\n */\nexport interface EventWithModifiers extends Event {\n  ctrlKey: boolean;\n  shiftKey: boolean;\n  altKey: boolean;\n  metaKey: boolean;\n}\n\n/**\n * Options that are applicable to all event handlers.\n *\n * This library has not yet had a need for stopPropagationImmediate.\n */\nexport interface EventHandlerOptions {\n  stopPropagation: boolean;\n  preventDefault: boolean;\n}\n\n/** A basic event handler. */\nexport type EventHandler<T extends Event> = (event: T) => void;\n\n/** A function that determines whether an event is to be handled. */\nexport type EventMatcher<T extends Event> = (event: T) => boolean;\n\n/** A config that specifies how to handle a particular event. */\nexport interface EventHandlerConfig<T extends Event> extends EventHandlerOptions {\n  matcher: EventMatcher<T>;\n  handler: EventHandler<T>;\n}\n\n/** Bit flag representation of the possible modifier keys that can be present on an event. */\nexport enum Modifier {\n  None = 0,\n  Ctrl = 0b1,\n  Shift = 0b10,\n  Alt = 0b100,\n  Meta = 0b1000,\n  Any = 'Any',\n}\n\nexport type ModifierInputs = Modifier | Modifier[];\n\n/**\n * Abstract base class for all event managers.\n *\n * Event managers are designed to normalize how event handlers are authored and create a safety net\n * for common event handling gotchas like remembering to call preventDefault or stopPropagation.\n */\nexport abstract class EventManager<T extends Event> {\n  protected configs: EventHandlerConfig<T>[] = [];\n  abstract options: EventHandlerOptions;\n\n  /** Runs the handlers that match with the given event. */\n  handle(event: T): void {\n    for (const config of this.configs) {\n      if (config.matcher(event)) {\n        config.handler(event);\n\n        if (config.preventDefault) {\n          event.preventDefault();\n        }\n\n        if (config.stopPropagation) {\n          event.stopPropagation();\n        }\n      }\n    }\n  }\n\n  /** Configures the event manager to handle specific events. (See subclasses for more). */\n  abstract on(...args: [...unknown[]]): this;\n}\n\n/** Gets bit flag representation of the modifier keys present on the given event. */\nexport function getModifiers(event: EventWithModifiers): number {\n  return (\n    (+event.ctrlKey && Modifier.Ctrl) |\n    (+event.shiftKey && Modifier.Shift) |\n    (+event.altKey && Modifier.Alt) |\n    (+event.metaKey && Modifier.Meta)\n  );\n}\n\n/**\n * Checks if the given event has modifiers that are an exact match for any of the given modifier\n * flag combinations.\n */\nexport function hasModifiers(event: EventWithModifiers, modifiers: ModifierInputs): boolean {\n  const eventModifiers = getModifiers(event);\n  const modifiersList = Array.isArray(modifiers) ? modifiers : [modifiers];\n\n  if (modifiersList.includes(Modifier.Any)) {\n    return true;\n  }\n\n  return modifiersList.some(modifiers => eventModifiers === modifiers);\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {SignalLike} from '../signal-like/signal-like';\nimport {\n  EventHandler,\n  EventHandlerOptions,\n  EventManager,\n  hasModifiers,\n  ModifierInputs,\n  Modifier,\n} from './event-manager';\n\n/**\n * Used to represent a keycode.\n *\n * This is used to match whether an events keycode should be handled. The ability to match using a\n * string, SignalLike, or Regexp gives us more flexibility when authoring event handlers.\n */\ntype KeyCode = string | SignalLike<string> | RegExp;\n\n/**\n * An event manager that is specialized for handling keyboard events. By default this manager stops\n * propagation and prevents default on all events it handles.\n */\nexport class KeyboardEventManager<T extends KeyboardEvent> extends EventManager<T> {\n  options: EventHandlerOptions = {\n    preventDefault: true,\n    stopPropagation: true,\n  };\n\n  /** Configures this event manager to handle events with a specific key and no modifiers. */\n  on(key: KeyCode, handler: EventHandler<T>, options?: Partial<EventHandlerOptions>): this;\n\n  /**  Configures this event manager to handle events with a specific modifer and key combination. */\n  on(\n    modifiers: ModifierInputs,\n    key: KeyCode,\n    handler: EventHandler<T>,\n    options?: Partial<EventHandlerOptions>,\n  ): this;\n\n  on(...args: any[]) {\n    const {modifiers, key, handler, options} = this._normalizeInputs(...args);\n\n    this.configs.push({\n      handler: handler,\n      matcher: event => this._isMatch(event, key, modifiers),\n      ...this.options,\n      ...options,\n    });\n\n    return this;\n  }\n\n  private _normalizeInputs(...args: any[]) {\n    const withModifiers = Array.isArray(args[0]) || args[0] in Modifier;\n    const modifiers = withModifiers ? args[0] : Modifier.None;\n    const key = withModifiers ? args[1] : args[0];\n    const handler = withModifiers ? args[2] : args[1];\n    const options = withModifiers ? args[3] : args[2];\n\n    return {\n      key: key as KeyCode,\n      handler: handler as EventHandler<T>,\n      modifiers: modifiers as ModifierInputs,\n      options: (options ?? {}) as Partial<EventHandlerOptions>,\n    };\n  }\n\n  private _isMatch(event: T, key: KeyCode, modifiers: ModifierInputs) {\n    if (!hasModifiers(event, modifiers)) {\n      return false;\n    }\n\n    if (key instanceof RegExp) {\n      return key.test(event.key);\n    }\n\n    const keyStr = typeof key === 'string' ? key : key();\n    return keyStr.toLowerCase() === event.key.toLowerCase();\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  createComputed,\n  createLinkedSignal,\n  createSignal,\n  linkedSignalSetFn,\n  linkedSignalUpdateFn,\n  SIGNAL,\n  untracked as primitiveUntracked,\n} from '@angular/core/primitives/signals';\n\nexport {primitiveUntracked as untracked};\n\nexport type SignalLike<T> = () => T;\n\nexport interface WritableSignalLike<T> extends SignalLike<T> {\n  set(value: T): void;\n  update(updateFn: (value: T) => T): void;\n  asReadonly(): SignalLike<T>;\n}\n\n/** Converts a getter setter style signal to a WritableSignalLike. */\nexport function convertGetterSetterToWritableSignalLike<T>(\n  getter: () => T,\n  setter: (v: T) => void,\n): WritableSignalLike<T> {\n  // tslint:disable-next-line:ban Have to use `Object.assign` to preserve the getter function.\n  return Object.assign(getter, {\n    set: setter,\n    update: (updateCallback: (v: T) => T) => setter(updateCallback(getter())),\n    asReadonly: () => getter,\n  });\n}\n\nexport function computed<T>(computation: () => T): SignalLike<T> {\n  const computed = createComputed(computation);\n  // TODO: Remove the `toString` after https://github.com/angular/angular/pull/65948 is merged.\n  computed.toString = () => `[Computed: ${computed()}]`;\n  computed[SIGNAL].debugName = '';\n  return computed;\n}\n\nexport function signal<T>(initialValue: T): WritableSignalLike<T> {\n  const [get, set, update] = createSignal(initialValue);\n  get[SIGNAL].debugName = '';\n  // tslint:disable-next-line:ban Have to use `Object.assign` to preserve the getter function.\n  return Object.assign(get, {set, update, asReadonly: () => get});\n}\n\nexport function linkedSignal<T>(sourceFn: () => T): WritableSignalLike<T> {\n  const getter = createLinkedSignal(sourceFn, s => s);\n  getter[SIGNAL].debugName = '';\n  // tslint:disable-next-line:ban Have to use `Object.assign` to preserve the getter function.\n  return Object.assign(getter, {\n    set: (v: T) => linkedSignalSetFn(getter[SIGNAL], v),\n    update: (updater: (v: T) => T) => linkedSignalUpdateFn(getter[SIGNAL], updater),\n    asReadonly: () => getter,\n  });\n}\n"],"names":["Modifier","EventManager","configs","handle","event","config","matcher","handler","preventDefault","stopPropagation","getModifiers","ctrlKey","Ctrl","shiftKey","Shift","altKey","Alt","metaKey","Meta","hasModifiers","modifiers","eventModifiers","modifiersList","Array","isArray","includes","Any","some","KeyboardEventManager","options","on","args","key","_normalizeInputs","push","_isMatch","withModifiers","None","RegExp","test","keyStr","toLowerCase","convertGetterSetterToWritableSignalLike","getter","setter","Object","assign","set","update","updateCallback","asReadonly","computed","computation","createComputed","toString","SIGNAL","debugName","signal","initialValue","get","createSignal","linkedSignal","sourceFn","createLinkedSignal","s","v","linkedSignalSetFn","updater","linkedSignalUpdateFn"],"mappings":"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"}