{"version":3,"file":"_combobox-tree-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/tree/tree.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/tree/tree.ts","../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/tree/combobox-tree.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal, SignalLike} from '../signal-like/signal-like';\nimport {ExpansionItem, ListExpansion, ListExpansionInputs} from '../expansion/expansion';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../list-focus/list-focus';\nimport {\n  ListNavigation,\n  ListNavigationInputs,\n  ListNavigationItem,\n} from '../list-navigation/list-navigation';\nimport {\n  ListSelection,\n  ListSelectionInputs,\n  ListSelectionItem,\n} from '../list-selection/list-selection';\nimport {\n  ListTypeahead,\n  ListTypeaheadInputs,\n  ListTypeaheadItem,\n} from '../list-typeahead/list-typeahead';\nimport {NavOptions} from '../list/list';\n\n/** Represents an item in the tree. */\nexport interface TreeItem<V, T extends TreeItem<V, T>>\n  extends\n    ListTypeaheadItem,\n    ListNavigationItem,\n    ListSelectionItem<V>,\n    ListFocusItem,\n    ExpansionItem {\n  /** The children of this item. */\n  children: SignalLike<T[] | undefined>;\n\n  /** The parent of this item. */\n  parent: SignalLike<T | undefined>;\n\n  /** Whether this item is visible. */\n  visible: SignalLike<boolean>;\n}\n\n/** The necessary inputs for the tree behavior. */\nexport type TreeInputs<T extends TreeItem<V, T>, V> = ListFocusInputs<T> &\n  ListNavigationInputs<T> &\n  ListSelectionInputs<T, V> &\n  ListTypeaheadInputs<T> &\n  ListExpansionInputs;\n\n/** Controls focus for a tree, ensuring that only visible items are focusable. */\nclass TreeListFocus<T extends TreeItem<V, T>, V> extends ListFocus<T> {\n  override isFocusable(item: T): boolean {\n    return super.isFocusable(item) && item.visible();\n  }\n}\n\n/** Controls the state of a tree. */\nexport class Tree<T extends TreeItem<V, T>, V> {\n  /** Controls navigation for the tree. */\n  navigationBehavior: ListNavigation<T>;\n\n  /** Controls selection for the tree. */\n  selectionBehavior: ListSelection<T, V>;\n\n  /** Controls typeahead for the tree. */\n  typeaheadBehavior: ListTypeahead<T>;\n\n  /** Controls focus for the tree. */\n  focusBehavior: ListFocus<T>;\n\n  /** Controls expansion for the tree. */\n  expansionBehavior: ListExpansion;\n\n  /** Whether the tree is disabled. */\n  disabled = computed(() => this.focusBehavior.isListDisabled());\n\n  /** The id of the current active item. */\n  activeDescendant = computed(() => this.focusBehavior.getActiveDescendant());\n\n  /** The tab index of the tree. */\n  tabIndex = computed(() => this.focusBehavior.getListTabIndex());\n\n  /** The index of the currently active item in the tree (within the flattened list). */\n  activeIndex = computed(() => this.focusBehavior.activeIndex());\n\n  /** The uncommitted index for selecting a range of options. */\n  private _anchorIndex = signal(0);\n\n  /** Whether the list should wrap. */\n  private _wrap = signal(true);\n\n  constructor(readonly inputs: TreeInputs<T, V>) {\n    this.focusBehavior = new TreeListFocus<T, V>(inputs);\n    this.selectionBehavior = new ListSelection<T, V>({...inputs, focusManager: this.focusBehavior});\n    this.typeaheadBehavior = new ListTypeahead<T>({...inputs, focusManager: this.focusBehavior});\n    this.expansionBehavior = new ListExpansion(inputs);\n    this.navigationBehavior = new ListNavigation<T>({\n      ...inputs,\n      focusManager: this.focusBehavior,\n      wrap: computed(() => this._wrap() && this.inputs.wrap()),\n    });\n  }\n\n  /** Returns the tab index for the given item. */\n  getItemTabindex(item: T) {\n    return this.focusBehavior.getItemTabIndex(item);\n  }\n\n  /** Navigates to the first option in the tree. */\n  first(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.first(opts));\n  }\n\n  /** Navigates to the last option in the tree. */\n  last(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.last(opts));\n  }\n\n  /** Navigates to the next option in the tree. */\n  next(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.next(opts));\n  }\n\n  /** Navigates to the previous option in the tree. */\n  prev(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.prev(opts));\n  }\n\n  /** Navigates to the first child of the current active item. */\n  firstChild(opts?: NavOptions<T>) {\n    this._navigate(opts, () => {\n      const item = this.inputs.activeItem();\n      const items = item?.children?.() ?? [];\n      return this.navigationBehavior.first({items, ...opts});\n    });\n  }\n\n  /** Navigates to the last child of the current active item. */\n  lastChild(opts?: NavOptions<T>) {\n    this._navigate(opts, () => {\n      const item = this.inputs.activeItem();\n      const items = item?.children?.() ?? [];\n      return this.navigationBehavior.last({items, ...opts});\n    });\n  }\n\n  /** Navigates to the next sibling of the current active item. */\n  nextSibling(opts?: NavOptions<T>) {\n    this._navigate(opts, () => {\n      const item = this.inputs.activeItem();\n      const items = item?.parent?.()?.children?.() ?? [];\n      return this.navigationBehavior.next({items, ...opts});\n    });\n  }\n\n  /** Navigates to the previous sibling of the current active item. */\n  prevSibling(opts?: NavOptions<T>) {\n    this._navigate(opts, () => {\n      const item = this.inputs.activeItem();\n      const items = item?.parent?.()?.children?.() ?? [];\n      return this.navigationBehavior.prev({items, ...opts});\n    });\n  }\n\n  /** Navigates to the parent of the current active item. */\n  parent(opts?: NavOptions<T>) {\n    this._navigate(opts, () =>\n      this.navigationBehavior.goto(this.inputs.activeItem()?.parent?.(), opts),\n    );\n  }\n\n  /** Navigates to the given item in the tree. */\n  goto(item: T, opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.goto(item, opts));\n  }\n\n  /** Removes focus from the tree. */\n  unfocus() {\n    this.inputs.activeItem.set(undefined);\n  }\n\n  /** Marks the given index as the potential start of a range selection. */\n  anchor(index: number) {\n    this._anchorIndex.set(index);\n  }\n\n  /** Handles typeahead search navigation for the tree. */\n  search(char: string, opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.typeaheadBehavior.search(char));\n  }\n\n  /** Checks if the tree is currently typing for typeahead search. */\n  isTyping() {\n    return this.typeaheadBehavior.isTyping();\n  }\n\n  /** Selects the currently active item in the tree. */\n  select(item?: T) {\n    this.selectionBehavior.select(item);\n  }\n\n  /** Sets the selection to only the current active item. */\n  selectOne() {\n    this.selectionBehavior.selectOne();\n  }\n\n  /** Deselects the currently active item in the tree. */\n  deselect(item?: T) {\n    this.selectionBehavior.deselect(item);\n  }\n\n  /** Deselects all items in the tree. */\n  deselectAll() {\n    this.selectionBehavior.deselectAll();\n  }\n\n  /** Toggles the currently active item in the tree. */\n  toggle(item?: T) {\n    this.selectionBehavior.toggle(item);\n  }\n\n  /** Toggles the currently active item in the tree, deselecting all other items. */\n  toggleOne() {\n    this.selectionBehavior.toggleOne();\n  }\n\n  /** Toggles the selection of all items in the tree. */\n  toggleAll() {\n    this.selectionBehavior.toggleAll();\n  }\n\n  /** Toggles the expansion of the given item. */\n  toggleExpansion(item?: T) {\n    item ??= this.inputs.activeItem();\n    if (!item || !this.isFocusable(item)) return;\n\n    if (this.isExpandable(item)) {\n      this.expansionBehavior.toggle(item);\n    }\n  }\n\n  /** Expands the given item. */\n  expand(item: T) {\n    if (this.isExpandable(item)) {\n      this.expansionBehavior.open(item);\n    }\n  }\n\n  /** Collapses the given item. */\n  collapse(item: T) {\n    this.expansionBehavior.close(item);\n  }\n\n  /** Expands all sibling items of the given item (or active item). */\n  expandSiblings(item?: T) {\n    item ??= this.inputs.activeItem();\n    if (!item) return;\n\n    const parent = item.parent?.();\n    // TODO: This assumes that items without a parent are root items.\n    const siblings = parent ? parent.children?.() : this.inputs.items().filter(i => !i.parent?.());\n    siblings?.forEach(s => this.expand(s));\n  }\n\n  /** Expands all items in the tree. */\n  expandAll() {\n    this.expansionBehavior.openAll();\n  }\n\n  /** Collapses all items in the tree. */\n  collapseAll() {\n    this.expansionBehavior.closeAll();\n  }\n\n  /** Checks if the given item is able to receive focus. */\n  isFocusable(item: T) {\n    return this.focusBehavior.isFocusable(item);\n  }\n\n  /** Checks if the given item is expandable. */\n  isExpandable(item: T) {\n    return this.expansionBehavior.isExpandable(item);\n  }\n\n  /** Handles updating selection for the tree. */\n  updateSelection(opts: NavOptions<T> = {anchor: true}) {\n    if (opts.toggle) {\n      this.selectionBehavior.toggle();\n    }\n    if (opts.select) {\n      this.selectionBehavior.select();\n    }\n    if (opts.selectOne) {\n      this.selectionBehavior.selectOne();\n    }\n    if (opts.selectRange) {\n      this.selectionBehavior.selectRange();\n    }\n    if (!opts.anchor) {\n      this.anchor(this.selectionBehavior.rangeStartIndex());\n    }\n  }\n\n  /**\n   * Safely performs a navigation operation.\n   */\n  private _navigate(opts: NavOptions<T> = {}, operation: () => boolean) {\n    if (opts?.selectRange) {\n      this._wrap.set(false);\n      this.selectionBehavior.rangeStartIndex.set(this._anchorIndex());\n    }\n\n    const moved = operation();\n\n    if (moved) {\n      this.updateSelection(opts);\n    }\n\n    this._wrap.set(true);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {SignalLike, computed, WritableSignalLike} from '../behaviors/signal-like/signal-like';\nimport {Tree, TreeItem, TreeInputs as TreeBehaviorInputs} from '../behaviors/tree/tree';\nimport {KeyboardEventManager, PointerEventManager, Modifier} from '../behaviors/event-manager';\n\n/** Represents the required inputs for a tree item. */\nexport interface TreeItemInputs<V> extends Omit<\n  TreeItem<V, TreeItemPattern<V>>,\n  'index' | 'parent' | 'visible' | 'expandable'\n> {\n  /** The parent item. */\n  parent: SignalLike<TreeItemPattern<V> | TreePattern<V>>;\n\n  /** Whether this item has children. Children can be lazily loaded. */\n  hasChildren: SignalLike<boolean>;\n\n  /** The tree pattern this item belongs to. */\n  tree: SignalLike<TreePattern<V>>;\n}\n\n/**\n * Represents an item in a Tree.\n */\nexport class TreeItemPattern<V> implements TreeItem<V, TreeItemPattern<V>> {\n  /** A unique identifier for this item. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The value of this item. */\n  readonly value: SignalLike<V> = () => this.inputs.value();\n\n  /** A reference to the item element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether the item is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The text used by the typeahead search. */\n  readonly searchTerm: SignalLike<string> = () => this.inputs.searchTerm();\n\n  /** The tree pattern this item belongs to. */\n  readonly tree: SignalLike<TreePattern<V>> = () => this.inputs.tree();\n\n  /** The parent item. */\n  readonly parent: SignalLike<TreeItemPattern<V> | undefined> = computed(() => {\n    const parent = this.inputs.parent();\n    return parent instanceof TreeItemPattern ? parent : undefined;\n  });\n\n  /** The children items. */\n  readonly children: SignalLike<TreeItemPattern<V>[]> = () => this.inputs.children() ?? [];\n\n  /** The position of this item among its siblings. */\n  readonly index = computed(() => this.tree().inputs.items().indexOf(this));\n\n  /** Whether the item is expandable. It's expandable if children item exist. */\n  readonly expandable: SignalLike<boolean> = () => this.inputs.hasChildren();\n\n  /** Whether the item is selectable. */\n  readonly selectable: SignalLike<boolean> = () => this.inputs.selectable();\n\n  /** Whether the item is expanded. */\n  readonly expanded: WritableSignalLike<boolean>;\n\n  /** The level of the current item in a tree. */\n  readonly level: SignalLike<number> = computed(() => this.inputs.parent().level() + 1);\n\n  /** Whether this item is visible. */\n  readonly visible: SignalLike<boolean> = computed(\n    () => this.inputs.parent().expanded() && this.inputs.parent().visible(),\n  );\n\n  /** The number of items under the same parent at the same level. */\n  readonly setsize = computed(() => this.inputs.parent().children().length);\n\n  /** The position of this item among its siblings (1-based). */\n  readonly posinset = computed(() => this.inputs.parent().children().indexOf(this) + 1);\n\n  /** Whether the item is active. */\n  readonly active = computed(() => this.tree().activeItem() === this);\n\n  /** The tab index of the item. */\n  readonly tabIndex = computed(() => this.tree().treeBehavior.getItemTabindex(this));\n\n  /** Whether the item is selected. */\n  readonly selected: SignalLike<boolean | undefined> = computed(() => {\n    if (this.tree().nav()) {\n      return undefined;\n    }\n    if (!this.selectable()) {\n      return undefined;\n    }\n    return this.tree().values().includes(this.value());\n  });\n\n  /** The current type of this item. */\n  readonly current: SignalLike<string | undefined> = computed(() => {\n    if (!this.tree().nav()) {\n      return undefined;\n    }\n    if (!this.selectable()) {\n      return undefined;\n    }\n    return this.tree().values().includes(this.value()) ? this.tree().currentType() : undefined;\n  });\n\n  constructor(readonly inputs: TreeItemInputs<V>) {\n    this.expanded = inputs.expanded;\n  }\n}\n\n/** The selection operations that the tree can perform. */\ninterface SelectOptions {\n  toggle?: boolean;\n  selectOne?: boolean;\n  selectRange?: boolean;\n  anchor?: boolean;\n}\n\n/** Represents the required inputs for a tree. */\nexport interface TreeInputs<V> extends Omit<\n  TreeBehaviorInputs<TreeItemPattern<V>, V>,\n  'multiExpandable'\n> {\n  /** A unique identifier for the tree. */\n  id: SignalLike<string>;\n\n  /** Whether the tree is in navigation mode. */\n  nav: SignalLike<boolean>;\n\n  /** The aria-current type. */\n  currentType: SignalLike<'page' | 'step' | 'location' | 'date' | 'time' | 'true' | 'false'>;\n\n  /** The text direction of the tree. */\n  textDirection: SignalLike<'ltr' | 'rtl'>;\n}\n\n/** Controls the state and interactions of a tree view. */\nexport class TreePattern<V> implements TreeInputs<V> {\n  /** The tree behavior for the tree. */\n  readonly treeBehavior: Tree<TreeItemPattern<V>, V>;\n\n  /** The root level is 0. */\n  readonly level = () => 0;\n\n  /** The root is always expanded. */\n  readonly expanded = () => true;\n\n  /** The root is always visible. */\n  readonly visible = () => true;\n\n  /** The tab index of the tree. */\n  readonly tabIndex: SignalLike<-1 | 0> = computed(() => this.treeBehavior.tabIndex());\n\n  /** The id of the current active item. */\n  readonly activeDescendant = computed(() => this.treeBehavior.activeDescendant());\n\n  /** The direct children of the root (top-level tree items). */\n  readonly children = computed(() =>\n    this.inputs.items().filter(item => item.level() === this.level() + 1),\n  );\n\n  /** Whether the tree selection follows focus. */\n  readonly followFocus = computed(() => this.inputs.selectionMode() === 'follow');\n\n  /** Whether the tree direction is RTL. */\n  readonly isRtl = computed(() => this.inputs.textDirection() === 'rtl');\n\n  /** The key for navigating to the previous item. */\n  readonly prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.isRtl() ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key for navigating to the next item. */\n  readonly nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.isRtl() ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The key for collapsing an item or moving to its parent. */\n  readonly collapseKey = computed(() => {\n    if (this.inputs.orientation() === 'horizontal') {\n      return 'ArrowUp';\n    }\n    return this.isRtl() ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key for expanding an item or moving to its first child. */\n  readonly expandKey = computed(() => {\n    if (this.inputs.orientation() === 'horizontal') {\n      return 'ArrowDown';\n    }\n    return this.isRtl() ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** Represents the space key. Does nothing when the user is actively using typeahead. */\n  readonly dynamicSpaceKey = computed(() => (this.treeBehavior.isTyping() ? '' : ' '));\n\n  /** Regular expression to match characters for typeahead. */\n  readonly typeaheadRegexp = /^.$/;\n\n  /** The keydown event manager for the tree. */\n  readonly keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n    const tree = this.treeBehavior;\n\n    manager\n      .on(this.prevKey, () => tree.prev({selectOne: this.followFocus()}))\n      .on(this.nextKey, () => tree.next({selectOne: this.followFocus()}))\n      .on('Home', () => tree.first({selectOne: this.followFocus()}))\n      .on('End', () => tree.last({selectOne: this.followFocus()}))\n      .on(this.typeaheadRegexp, e => tree.search(e.key, {selectOne: this.followFocus()}))\n      .on(Modifier.Shift, '*', () => tree.expandSiblings())\n      .on(this.expandKey, () => this._expandOrFirstChild({selectOne: this.followFocus()}))\n      .on(this.collapseKey, () => this._collapseOrParent({selectOne: this.followFocus()}));\n\n    if (this.inputs.multi()) {\n      manager\n        // TODO: Tracking the anchor by index can break if the\n        // tree is expanded or collapsed causing the index to change.\n        .on(Modifier.Any, 'Shift', () => tree.anchor(this.treeBehavior.activeIndex()))\n        .on(Modifier.Shift, this.prevKey, () => tree.prev({selectRange: true}))\n        .on(Modifier.Shift, this.nextKey, () => tree.next({selectRange: true}))\n        .on([Modifier.Ctrl | Modifier.Shift, Modifier.Meta | Modifier.Shift], 'Home', () =>\n          tree.first({selectRange: true, anchor: false}),\n        )\n        .on([Modifier.Ctrl | Modifier.Shift, Modifier.Meta | Modifier.Shift], 'End', () =>\n          tree.last({selectRange: true, anchor: false}),\n        )\n        .on(Modifier.Shift, 'Enter', () => tree.updateSelection({selectRange: true, anchor: false}))\n        .on(Modifier.Shift, this.dynamicSpaceKey, () =>\n          tree.updateSelection({selectRange: true, anchor: false}),\n        );\n    }\n\n    if (!this.followFocus() && this.inputs.multi()) {\n      manager\n        .on(this.dynamicSpaceKey, () => tree.toggle())\n        .on('Enter', () => tree.toggle(), {preventDefault: !this.nav()})\n        .on([Modifier.Ctrl, Modifier.Meta], 'A', () => tree.toggleAll());\n    }\n\n    if (!this.followFocus() && !this.inputs.multi()) {\n      manager.on(this.dynamicSpaceKey, () => tree.selectOne());\n      manager.on('Enter', () => tree.selectOne(), {preventDefault: !this.nav()});\n    }\n\n    if (this.inputs.multi() && this.followFocus()) {\n      manager\n        .on([Modifier.Ctrl, Modifier.Meta], this.prevKey, () => tree.prev())\n        .on([Modifier.Ctrl, Modifier.Meta], this.nextKey, () => tree.next())\n        .on([Modifier.Ctrl, Modifier.Meta], this.expandKey, () => this._expandOrFirstChild())\n        .on([Modifier.Ctrl, Modifier.Meta], this.collapseKey, () => this._collapseOrParent())\n        .on([Modifier.Ctrl, Modifier.Meta], ' ', () => tree.toggle())\n        .on([Modifier.Ctrl, Modifier.Meta], 'Enter', () => tree.toggle())\n        .on([Modifier.Ctrl, Modifier.Meta], 'Home', () => tree.first())\n        .on([Modifier.Ctrl, Modifier.Meta], 'End', () => tree.last())\n        .on([Modifier.Ctrl, Modifier.Meta], 'A', () => {\n          tree.toggleAll();\n          tree.select(); // Ensure the currect item remains selected.\n        });\n    }\n\n    return manager;\n  });\n\n  /** The pointerdown event manager for the tree. */\n  pointerdown = computed(() => {\n    const manager = new PointerEventManager();\n\n    if (this.multi()) {\n      manager.on(Modifier.Shift, e => this.goto(e, {selectRange: true}));\n    }\n\n    if (!this.multi()) {\n      return manager.on(e => this.goto(e, {selectOne: true}));\n    }\n\n    if (this.multi() && this.followFocus()) {\n      return manager\n        .on(e => this.goto(e, {selectOne: true}))\n        .on(Modifier.Ctrl, e => this.goto(e, {toggle: true}));\n    }\n\n    if (this.multi() && !this.followFocus()) {\n      return manager.on(e => this.goto(e, {toggle: true}));\n    }\n\n    return manager;\n  });\n\n  /** A unique identifier for the tree. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The host native element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether the tree is in navigation mode. */\n  readonly nav: SignalLike<boolean> = () => this.inputs.nav();\n\n  /** The aria-current type. */\n  readonly currentType: SignalLike<\n    'page' | 'step' | 'location' | 'date' | 'time' | 'true' | 'false'\n  > = () => this.inputs.currentType();\n\n  /** All items in the tree, in document order (DFS-like, a flattened list). */\n  readonly items: SignalLike<TreeItemPattern<V>[]> = () => this.inputs.items();\n\n  /** The focus strategy used by the tree. */\n  readonly focusMode: SignalLike<'roving' | 'activedescendant'> = () => this.inputs.focusMode();\n\n  /** Whether the tree is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The currently active item in the tree. */\n  readonly activeItem: WritableSignalLike<TreeItemPattern<V> | undefined>;\n\n  /** Whether disabled items should be focusable. */\n  readonly softDisabled: SignalLike<boolean> = () => this.inputs.softDisabled();\n\n  /** Whether the focus should wrap when navigating past the first or last item. */\n  readonly wrap: SignalLike<boolean> = () => this.inputs.wrap();\n\n  /** The orientation of the tree. */\n  readonly orientation: SignalLike<'vertical' | 'horizontal'> = () => this.inputs.orientation();\n\n  /** The text direction of the tree. */\n  readonly textDirection: SignalLike<'ltr' | 'rtl'> = () => this.textDirection();\n\n  /** Whether multiple items can be selected at the same time. */\n  readonly multi: SignalLike<boolean> = computed(() => (this.nav() ? false : this.inputs.multi()));\n\n  /** The selection mode of the tree. */\n  readonly selectionMode: SignalLike<'follow' | 'explicit'> = () => this.inputs.selectionMode();\n\n  /** The delay in milliseconds to wait before clearing the typeahead buffer. */\n  readonly typeaheadDelay: SignalLike<number> = () => this.inputs.typeaheadDelay();\n\n  /** The current selected items of the tree. */\n  readonly values: WritableSignalLike<V[]>;\n\n  constructor(readonly inputs: TreeInputs<V>) {\n    this.activeItem = inputs.activeItem;\n    this.values = inputs.values;\n\n    this.treeBehavior = new Tree<TreeItemPattern<V>, V>({\n      ...inputs,\n      multi: this.multi,\n      multiExpandable: () => true,\n    });\n  }\n\n  /** Returns a set of violations */\n  validate(): string[] {\n    const violations: string[] = [];\n\n    if (!this.inputs.multi() && this.inputs.values().length > 1) {\n      violations.push(\n        `A single-select tree should not have multiple selected options. Selected options: ${this.inputs.values().join(', ')}`,\n      );\n    }\n\n    return violations;\n  }\n\n  /**\n   * Sets the tree to it's default initial state.\n   *\n   * Sets the active index of the tree to the first focusable selected tree item if one exists.\n   * Otherwise, sets focus to the first focusable tree item.\n   */\n  setDefaultState() {\n    let firstItem: TreeItemPattern<V> | undefined;\n\n    for (const item of this.inputs.items()) {\n      if (!item.visible()) continue;\n      if (!this.treeBehavior.isFocusable(item)) continue;\n\n      if (firstItem === undefined) {\n        firstItem = item;\n      }\n\n      if (item.selected()) {\n        this.activeItem.set(item);\n        return;\n      }\n    }\n\n    if (firstItem !== undefined) {\n      this.activeItem.set(firstItem);\n    }\n  }\n\n  /** Handles keydown events on the tree. */\n  onKeydown(event: KeyboardEvent) {\n    if (!this.disabled()) {\n      this.keydown().handle(event);\n    }\n  }\n\n  /** Handles pointerdown events on the tree. */\n  onPointerdown(event: PointerEvent) {\n    if (!this.disabled()) {\n      this.pointerdown().handle(event);\n    }\n  }\n\n  /** Navigates to the given tree item in the tree. */\n  goto(e: PointerEvent, opts?: SelectOptions) {\n    const item = this._getItem(e);\n    if (!item) return;\n\n    this.treeBehavior.goto(item, opts);\n    this.treeBehavior.toggleExpansion(item);\n  }\n\n  /** Expands the active item if possible, otherwise navigates to the first child. */\n  _expandOrFirstChild(opts?: SelectOptions) {\n    const item = this.treeBehavior.inputs.activeItem();\n    if (item && this.treeBehavior.isExpandable(item) && !item.expanded()) {\n      this.treeBehavior.expand(item);\n    } else {\n      this.treeBehavior.firstChild(opts);\n    }\n  }\n\n  /** Collapses the active item if possible, otherwise navigates to the parent. */\n  _collapseOrParent(opts?: SelectOptions) {\n    const item = this.treeBehavior.inputs.activeItem();\n    if (item && this.treeBehavior.isExpandable(item) && item.expanded()) {\n      this.treeBehavior.collapse(item);\n    } else {\n      this.treeBehavior.parent(opts);\n    }\n  }\n\n  /** Retrieves the TreeItemPattern associated with a DOM event, if any. */\n  protected _getItem(event: Event): TreeItemPattern<V> | undefined {\n    if (!(event.target instanceof HTMLElement)) {\n      return;\n    }\n    const element = event.target.closest('[role=\"treeitem\"]');\n    return this.inputs.items().find(i => i.element() === element);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {TreeInputs, TreePattern, TreeItemPattern} from './tree';\nimport {computed, SignalLike} from '../behaviors/signal-like/signal-like';\nimport {ComboboxPattern, ComboboxTreeControls} from '../combobox/combobox';\n\nexport type ComboboxTreeInputs<V> = TreeInputs<V> & {\n  /** The combobox controlling the tree. */\n  combobox: SignalLike<ComboboxPattern<TreeItemPattern<V>, V> | undefined>;\n};\n\nexport class ComboboxTreePattern<V>\n  extends TreePattern<V>\n  implements ComboboxTreeControls<TreeItemPattern<V>, V>\n{\n  /** Toggles to expand or collapse a tree item. */\n  toggleExpansion = (item?: TreeItemPattern<V>) => this.treeBehavior.toggleExpansion(item);\n\n  /** Whether the currently focused item is collapsible. */\n  isItemCollapsible = () => this.inputs.activeItem()?.parent() instanceof TreeItemPattern;\n\n  /** The ARIA role for the tree. */\n  role = () => 'tree' as const;\n\n  /* The id of the active (focused) item in the tree. */\n  activeId = computed(() => this.treeBehavior.activeDescendant());\n\n  /** Returns the currently active (focused) item in the tree. */\n  getActiveItem = () => this.inputs.activeItem();\n\n  /** The list of items in the tree. */\n  override items = computed(() => this.inputs.items());\n\n  /** The tab index for the tree. Always -1 because the combobox handles focus. */\n  override tabIndex: SignalLike<-1 | 0> = () => -1;\n\n  constructor(override readonly inputs: ComboboxTreeInputs<V>) {\n    if (inputs.combobox()) {\n      inputs.multi = () => false;\n      inputs.focusMode = () => 'activedescendant';\n      inputs.element = inputs.combobox()!.inputs.inputEl;\n    }\n\n    super(inputs);\n  }\n\n  /** Noop. The combobox handles keydown events. */\n  override onKeydown(_: KeyboardEvent): void {}\n\n  /** Noop. The combobox handles pointerdown events. */\n  override onPointerdown(_: PointerEvent): void {}\n\n  /** Noop. The combobox controls the open state. */\n  override setDefaultState(): void {}\n\n  /** Navigates to the specified item in the tree. */\n  focus = (item: TreeItemPattern<V>) => this.treeBehavior.goto(item);\n\n  /** Navigates to the next focusable item in the tree. */\n  next = () => this.treeBehavior.next();\n\n  /** Navigates to the previous focusable item in the tree. */\n  prev = () => this.treeBehavior.prev();\n\n  /** Navigates to the last focusable item in the tree. */\n  last = () => this.treeBehavior.last();\n\n  /** Navigates to the first focusable item in the tree. */\n  first = () => this.treeBehavior.first();\n\n  /** Unfocuses the currently focused item in the tree. */\n  unfocus = () => this.treeBehavior.unfocus();\n\n  // TODO: handle non-selectable parent nodes.\n  /** Selects the specified item in the tree or the current active item if not provided. */\n  select = (item?: TreeItemPattern<V>) => this.treeBehavior.select(item);\n\n  /** Toggles the selection state of the given item in the tree or the current active item if not provided. */\n  toggle = (item?: TreeItemPattern<V>) => this.treeBehavior.toggle(item);\n\n  /** Clears the selection in the tree. */\n  clearSelection = () => this.treeBehavior.deselectAll();\n\n  /** Retrieves the TreeItemPattern associated with a pointer event. */\n  getItem = (e: PointerEvent) => this._getItem(e);\n\n  /** Retrieves the currently selected items in the tree */\n  getSelectedItems = () => this.inputs.items().filter(item => item.selected());\n\n  /** Sets the value of the combobox tree. */\n  setValue = (value: V | undefined) => this.inputs.values.set(value ? [value] : []);\n\n  /** Expands the currently focused item if it is expandable, or navigates to the first child. */\n  expandItem = () => this._expandOrFirstChild();\n\n  /** Collapses the currently focused item if it is expandable, or navigates to the parent. */\n  collapseItem = () => this._collapseOrParent();\n\n  /** Whether the specified item or the currently active item is expandable. */\n  isItemExpandable(item: TreeItemPattern<V> | undefined = this.inputs.activeItem()) {\n    return item ? item.expandable() : false;\n  }\n\n  /** Expands all of the tree items. */\n  expandAll = () => this.treeBehavior.expandAll();\n\n  /** Collapses all of the tree items. */\n  collapseAll = () => this.treeBehavior.collapseAll();\n\n  /** Whether the currently active item is selectable. */\n  isItemSelectable = (item: TreeItemPattern<V> | undefined = this.inputs.activeItem()) => {\n    return item ? item.selectable() : false;\n  };\n}\n"],"names":["TreeListFocus","ListFocus","isFocusable","item","visible","Tree","inputs","navigationBehavior","selectionBehavior","typeaheadBehavior","focusBehavior","expansionBehavior","disabled","computed","isListDisabled","activeDescendant","getActiveDescendant","tabIndex","getListTabIndex","activeIndex","_anchorIndex","signal","_wrap","constructor","ListSelection","focusManager","ListTypeahead","ListExpansion","ListNavigation","wrap","getItemTabindex","getItemTabIndex","first","opts","_navigate","last","next","prev","firstChild","activeItem","items","children","lastChild","nextSibling","parent","prevSibling","goto","unfocus","set","undefined","anchor","index","search","char","isTyping","select","selectOne","deselect","deselectAll","toggle","toggleOne","toggleAll","toggleExpansion","isExpandable","expand","open","collapse","close","expandSiblings","siblings","filter","i","forEach","s","expandAll","openAll","collapseAll","closeAll","updateSelection","selectRange","rangeStartIndex","operation","moved","TreeItemPattern","id","value","element","searchTerm","tree","indexOf","expandable","hasChildren","selectable","expanded","level","setsize","length","posinset","active","treeBehavior","selected","nav","values","includes","current","currentType","TreePattern","followFocus","selectionMode","isRtl","textDirection","prevKey","orientation","nextKey","collapseKey","expandKey","dynamicSpaceKey","typeaheadRegexp","keydown","manager","KeyboardEventManager","on","e","key","Modifier","Shift","_expandOrFirstChild","_collapseOrParent","multi","Any","Ctrl","Meta","preventDefault","pointerdown","PointerEventManager","focusMode","softDisabled","typeaheadDelay","multiExpandable","validate","violations","push","join","setDefaultState","firstItem","onKeydown","event","handle","onPointerdown","_getItem","target","HTMLElement","closest","find","ComboboxTreePattern","isItemCollapsible","role","activeId","getActiveItem","combobox","inputEl","_","focus","clearSelection","getItem","getSelectedItems","setValue","expandItem","collapseItem","isItemExpandable","isItemSelectable"],"mappings":"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"}