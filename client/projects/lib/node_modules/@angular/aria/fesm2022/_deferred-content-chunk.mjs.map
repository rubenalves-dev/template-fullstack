{"version":3,"file":"_deferred-content-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/deferred-content/deferred-content.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  afterRenderEffect,\n  Directive,\n  inject,\n  TemplateRef,\n  signal,\n  ViewContainerRef,\n  model,\n  EmbeddedViewRef,\n  OnDestroy,\n} from '@angular/core';\n\n/**\n * A container directive controls the visibility of its content.\n */\n@Directive()\nexport class DeferredContentAware {\n  readonly contentVisible = signal(false);\n  readonly preserveContent = model(false);\n}\n\n/**\n * DeferredContent loads/unloads the content based on the visibility.\n * The visibilty signal is sent from a parent directive implements\n * DeferredContentAware.\n *\n * Use this directive as a host directive. For example:\n *\n * ```ts\n *   @Directive({\n *     selector: 'ng-template[AccordionContent]',\n *     hostDirectives: [DeferredContent],\n *   })\n *   class AccordionContent {}\n * ```\n */\n@Directive()\nexport class DeferredContent implements OnDestroy {\n  private readonly _deferredContentAware = inject(DeferredContentAware, {optional: true});\n  private readonly _templateRef = inject(TemplateRef);\n  private readonly _viewContainerRef = inject(ViewContainerRef);\n  private _currentViewRef: EmbeddedViewRef<unknown> | null = null;\n  private _isRendered = false;\n\n  readonly deferredContentAware = signal(this._deferredContentAware);\n\n  constructor() {\n    afterRenderEffect(() => {\n      if (this.deferredContentAware()?.contentVisible()) {\n        if (!this._isRendered) {\n          this._destroyContent();\n          this._currentViewRef = this._viewContainerRef.createEmbeddedView(this._templateRef);\n          this._isRendered = true;\n        }\n      } else if (!this.deferredContentAware()?.preserveContent()) {\n        this._destroyContent();\n        this._isRendered = false;\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    this._destroyContent();\n  }\n\n  private _destroyContent() {\n    const ref = this._currentViewRef;\n\n    if (ref && !ref.destroyed) {\n      ref.destroy();\n      this._currentViewRef = null;\n    }\n  }\n}\n"],"names":["DeferredContentAware","contentVisible","signal","preserveContent","model","deps","target","i0","ɵɵFactoryTarget","Directive","isStandalone","inputs","classPropertyName","publicName","isSignal","isRequired","transformFunction","outputs","ngImport","decorators","DeferredContent","_deferredContentAware","inject","optional","_templateRef","TemplateRef","_viewContainerRef","ViewContainerRef","_currentViewRef","_isRendered","deferredContentAware","constructor","afterRenderEffect","_destroyContent","createEmbeddedView","ngOnDestroy","ref","destroyed","destroy"],"mappings":";;;MAwBaA,oBAAoB,CAAA;EACtBC,cAAc,GAAGC,MAAM,CAAC,KAAK;;WAAC;EAC9BC,eAAe,GAAGC,KAAK,CAAC,KAAK;;WAAC;;;;;UAF5BJ,oBAAoB;AAAAK,IAAAA,IAAA,EAAA,EAAA;AAAAC,IAAAA,MAAA,EAAAC,EAAA,CAAAC,eAAA,CAAAC;AAAA,GAAA,CAAA;;;;UAApBT,oBAAoB;AAAAU,IAAAA,YAAA,EAAA,IAAA;AAAAC,IAAAA,MAAA,EAAA;AAAAR,MAAAA,eAAA,EAAA;AAAAS,QAAAA,iBAAA,EAAA,iBAAA;AAAAC,QAAAA,UAAA,EAAA,iBAAA;AAAAC,QAAAA,QAAA,EAAA,IAAA;AAAAC,QAAAA,UAAA,EAAA,KAAA;AAAAC,QAAAA,iBAAA,EAAA;AAAA;KAAA;AAAAC,IAAAA,OAAA,EAAA;AAAAd,MAAAA,eAAA,EAAA;KAAA;AAAAe,IAAAA,QAAA,EAAAX;AAAA,GAAA,CAAA;;;;;;QAApBP,oBAAoB;AAAAmB,EAAAA,UAAA,EAAA,CAAA;UADhCV;;;;;;;;;;;;;;;;MAsBYW,eAAe,CAAA;AACTC,EAAAA,qBAAqB,GAAGC,MAAM,CAACtB,oBAAoB,EAAE;AAACuB,IAAAA,QAAQ,EAAE;AAAK,GAAA,CAAC;AACtEC,EAAAA,YAAY,GAAGF,MAAM,CAACG,WAAW,CAAC;AAClCC,EAAAA,iBAAiB,GAAGJ,MAAM,CAACK,gBAAgB,CAAC;AACrDC,EAAAA,eAAe,GAAoC,IAAI;AACvDC,EAAAA,WAAW,GAAG,KAAK;EAElBC,oBAAoB,GAAG5B,MAAM,CAAC,IAAI,CAACmB,qBAAqB;;WAAC;AAElEU,EAAAA,WAAAA,GAAA;AACEC,IAAAA,iBAAiB,CAAC,MAAK;MACrB,IAAI,IAAI,CAACF,oBAAoB,EAAE,EAAE7B,cAAc,EAAE,EAAE;AACjD,QAAA,IAAI,CAAC,IAAI,CAAC4B,WAAW,EAAE;UACrB,IAAI,CAACI,eAAe,EAAE;AACtB,UAAA,IAAI,CAACL,eAAe,GAAG,IAAI,CAACF,iBAAiB,CAACQ,kBAAkB,CAAC,IAAI,CAACV,YAAY,CAAC;UACnF,IAAI,CAACK,WAAW,GAAG,IAAI;AACzB;AACF,OAAA,MAAO,IAAI,CAAC,IAAI,CAACC,oBAAoB,EAAE,EAAE3B,eAAe,EAAE,EAAE;QAC1D,IAAI,CAAC8B,eAAe,EAAE;QACtB,IAAI,CAACJ,WAAW,GAAG,KAAK;AAC1B;AACF,KAAC,CAAC;AACJ;AAEAM,EAAAA,WAAWA,GAAA;IACT,IAAI,CAACF,eAAe,EAAE;AACxB;AAEQA,EAAAA,eAAeA,GAAA;AACrB,IAAA,MAAMG,GAAG,GAAG,IAAI,CAACR,eAAe;AAEhC,IAAA,IAAIQ,GAAG,IAAI,CAACA,GAAG,CAACC,SAAS,EAAE;MACzBD,GAAG,CAACE,OAAO,EAAE;MACb,IAAI,CAACV,eAAe,GAAG,IAAI;AAC7B;AACF;;;;;UAnCWR,eAAe;AAAAf,IAAAA,IAAA,EAAA,EAAA;AAAAC,IAAAA,MAAA,EAAAC,EAAA,CAAAC,eAAA,CAAAC;AAAA,GAAA,CAAA;;;;UAAfW,eAAe;AAAAV,IAAAA,YAAA,EAAA,IAAA;AAAAQ,IAAAA,QAAA,EAAAX;AAAA,GAAA,CAAA;;;;;;QAAfa,eAAe;AAAAD,EAAAA,UAAA,EAAA,CAAA;UAD3BV;;;;;;;"}