{"version":3,"file":"_list-chunk.mjs","sources":["../../../../../darwin_arm64-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/list/list.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal} from '../signal-like/signal-like';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../list-focus/list-focus';\nimport {\n  ListNavigation,\n  ListNavigationInputs,\n  ListNavigationItem,\n} from '../list-navigation/list-navigation';\nimport {\n  ListSelection,\n  ListSelectionInputs,\n  ListSelectionItem,\n} from '../list-selection/list-selection';\nimport {\n  ListTypeahead,\n  ListTypeaheadInputs,\n  ListTypeaheadItem,\n} from '../list-typeahead/list-typeahead';\n\n/** The operations that the list can perform after navigation. */\nexport interface NavOptions<T = any> {\n  toggle?: boolean;\n  select?: boolean;\n  selectOne?: boolean;\n  selectRange?: boolean;\n  anchor?: boolean;\n  focusElement?: boolean;\n  items?: T[];\n}\n\n/** Represents an item in the list. */\nexport type ListItem<V> = ListTypeaheadItem &\n  ListNavigationItem &\n  ListSelectionItem<V> &\n  ListFocusItem;\n\n/** The necessary inputs for the list behavior. */\nexport type ListInputs<T extends ListItem<V>, V> = ListFocusInputs<T> &\n  ListNavigationInputs<T> &\n  ListSelectionInputs<T, V> &\n  ListTypeaheadInputs<T>;\n\n/** Controls the state of a list. */\nexport class List<T extends ListItem<V>, V> {\n  /** Controls navigation for the list. */\n  navigationBehavior: ListNavigation<T>;\n\n  /** Controls selection for the list. */\n  selectionBehavior: ListSelection<T, V>;\n\n  /** Controls typeahead for the list. */\n  typeaheadBehavior: ListTypeahead<T>;\n\n  /** Controls focus for the list. */\n  focusBehavior: ListFocus<T>;\n\n  /** Whether the list is disabled. */\n  disabled = computed(() => this.focusBehavior.isListDisabled());\n\n  /** The id of the current active item. */\n  activeDescendant = computed(() => this.focusBehavior.getActiveDescendant());\n\n  /** The tab index of the list. */\n  tabIndex = computed(() => this.focusBehavior.getListTabIndex());\n\n  /** The index of the currently active item in the list. */\n  activeIndex = computed(() => this.focusBehavior.activeIndex());\n\n  /**\n   * The uncommitted index for selecting a range of options.\n   *\n   * NOTE: This is subtly distinct from the \"rangeStartIndex\" in the ListSelection behavior.\n   * The anchorIndex does not necessarily represent the start of a range, but represents the most\n   * recent index where the user showed intent to begin a range selection. Usually, this is wherever\n   * the user most recently pressed the \"Shift\" key, but if the user presses shift + space to select\n   * from the anchor, the user is not intending to start a new range from this index.\n   *\n   * In other words, \"rangeStartIndex\" is only set when a user commits to starting a range selection\n   * while \"anchorIndex\" is set whenever a user indicates they may be starting a range selection.\n   */\n  private _anchorIndex = signal(0);\n\n  /** Whether the list should wrap. Used to disable wrapping while range selecting. */\n  private _wrap = signal(true);\n\n  constructor(readonly inputs: ListInputs<T, V>) {\n    this.focusBehavior = new ListFocus(inputs);\n    this.selectionBehavior = new ListSelection({...inputs, focusManager: this.focusBehavior});\n    this.typeaheadBehavior = new ListTypeahead({...inputs, focusManager: this.focusBehavior});\n    this.navigationBehavior = new ListNavigation({\n      ...inputs,\n      focusManager: this.focusBehavior,\n      wrap: computed(() => this._wrap() && this.inputs.wrap()),\n    });\n  }\n\n  /** Returns the tab index for the given item. */\n  getItemTabindex(item: T) {\n    return this.focusBehavior.getItemTabIndex(item);\n  }\n\n  /** Navigates to the first option in the list. */\n  first(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.first(opts));\n  }\n\n  /** Navigates to the last option in the list. */\n  last(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.last(opts));\n  }\n\n  /** Navigates to the next option in the list. */\n  next(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.next(opts));\n  }\n\n  /** Navigates to the previous option in the list. */\n  prev(opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.prev(opts));\n  }\n\n  /** Navigates to the given item in the list. */\n  goto(item: T, opts?: NavOptions<T>) {\n    this._navigate(opts, () => this.navigationBehavior.goto(item, opts));\n  }\n\n  /** Removes focus from the list. */\n  unfocus() {\n    this.inputs.activeItem.set(undefined);\n  }\n\n  /** Marks the given index as the potential start of a range selection. */\n  anchor(index: number) {\n    this._anchorIndex.set(index);\n  }\n\n  /** Handles typeahead search navigation for the list. */\n  search(char: string, opts?: NavOptions) {\n    this._navigate(opts, () => this.typeaheadBehavior.search(char));\n  }\n\n  /** Checks if the list is currently typing for typeahead search. */\n  isTyping() {\n    return this.typeaheadBehavior.isTyping();\n  }\n\n  /** Selects the currently active item in the list. */\n  select(item?: T) {\n    this.selectionBehavior.select(item);\n  }\n\n  /** Sets the selection to only the current active item. */\n  selectOne() {\n    this.selectionBehavior.selectOne();\n  }\n\n  /** Deselects the currently active item in the list. */\n  deselect(item?: T) {\n    this.selectionBehavior.deselect(item);\n  }\n\n  /** Deselects all items in the list. */\n  deselectAll() {\n    this.selectionBehavior.deselectAll();\n  }\n\n  /** Toggles the currently active item in the list. */\n  toggle(item?: T) {\n    this.selectionBehavior.toggle(item);\n  }\n\n  /** Toggles the currently active item in the list, deselecting all other items. */\n  toggleOne() {\n    this.selectionBehavior.toggleOne();\n  }\n\n  /** Toggles the selection of all items in the list. */\n  toggleAll() {\n    this.selectionBehavior.toggleAll();\n  }\n\n  /** Checks if the given item is able to receive focus. */\n  isFocusable(item: T) {\n    return this.focusBehavior.isFocusable(item);\n  }\n\n  /** Handles updating selection for the list. */\n  updateSelection(opts: NavOptions = {anchor: true}) {\n    if (opts.toggle) {\n      this.selectionBehavior.toggle();\n    }\n    if (opts.select) {\n      this.selectionBehavior.select();\n    }\n    if (opts.selectOne) {\n      this.selectionBehavior.selectOne();\n    }\n    if (opts.selectRange) {\n      this.selectionBehavior.selectRange();\n    }\n    if (!opts.anchor) {\n      this.anchor(this.selectionBehavior.rangeStartIndex());\n    }\n  }\n\n  /**\n   * Safely performs a navigation operation.\n   *\n   * Handles conditionally disabling wrapping for when a navigation\n   * operation is occurring while the user is selecting a range of options.\n   *\n   * Handles boilerplate calling of focus & selection operations. Also ensures these\n   * additional operations are only called if the navigation operation moved focus to a new option.\n   */\n  private _navigate(opts: NavOptions = {}, operation: () => boolean) {\n    if (opts?.selectRange) {\n      this._wrap.set(false);\n      this.selectionBehavior.rangeStartIndex.set(this._anchorIndex());\n    }\n\n    const moved = operation();\n\n    if (moved) {\n      this.updateSelection(opts);\n    }\n\n    this._wrap.set(true);\n  }\n}\n"],"names":["List","inputs","navigationBehavior","selectionBehavior","typeaheadBehavior","focusBehavior","disabled","computed","isListDisabled","activeDescendant","getActiveDescendant","tabIndex","getListTabIndex","activeIndex","_anchorIndex","signal","_wrap","constructor","ListFocus","ListSelection","focusManager","ListTypeahead","ListNavigation","wrap","getItemTabindex","item","getItemTabIndex","first","opts","_navigate","last","next","prev","goto","unfocus","activeItem","set","undefined","anchor","index","search","char","isTyping","select","selectOne","deselect","deselectAll","toggle","toggleOne","toggleAll","isFocusable","updateSelection","selectRange","rangeStartIndex","operation","moved"],"mappings":";;;;MAkDaA,IAAI,CAAA;EA0CMC,MAAA;EAxCrBC,kBAAkB;EAGlBC,iBAAiB;EAGjBC,iBAAiB;EAGjBC,aAAa;EAGbC,QAAQ,GAAGC,QAAQ,CAAC,MAAM,IAAI,CAACF,aAAa,CAACG,cAAc,EAAE,CAAC;EAG9DC,gBAAgB,GAAGF,QAAQ,CAAC,MAAM,IAAI,CAACF,aAAa,CAACK,mBAAmB,EAAE,CAAC;EAG3EC,QAAQ,GAAGJ,QAAQ,CAAC,MAAM,IAAI,CAACF,aAAa,CAACO,eAAe,EAAE,CAAC;EAG/DC,WAAW,GAAGN,QAAQ,CAAC,MAAM,IAAI,CAACF,aAAa,CAACQ,WAAW,EAAE,CAAC;AActDC,EAAAA,YAAY,GAAGC,MAAM,CAAC,CAAC,CAAC;AAGxBC,EAAAA,KAAK,GAAGD,MAAM,CAAC,IAAI,CAAC;EAE5BE,WAAAA,CAAqBhB,MAAwB,EAAA;IAAxB,IAAM,CAAAA,MAAA,GAANA,MAAM;AACzB,IAAA,IAAI,CAACI,aAAa,GAAG,IAAIa,SAAS,CAACjB,MAAM,CAAC;AAC1C,IAAA,IAAI,CAACE,iBAAiB,GAAG,IAAIgB,aAAa,CAAC;AAAC,MAAA,GAAGlB,MAAM;MAAEmB,YAAY,EAAE,IAAI,CAACf;AAAa,KAAC,CAAC;AACzF,IAAA,IAAI,CAACD,iBAAiB,GAAG,IAAIiB,aAAa,CAAC;AAAC,MAAA,GAAGpB,MAAM;MAAEmB,YAAY,EAAE,IAAI,CAACf;AAAa,KAAC,CAAC;AACzF,IAAA,IAAI,CAACH,kBAAkB,GAAG,IAAIoB,cAAc,CAAC;AAC3C,MAAA,GAAGrB,MAAM;MACTmB,YAAY,EAAE,IAAI,CAACf,aAAa;AAChCkB,MAAAA,IAAI,EAAEhB,QAAQ,CAAC,MAAM,IAAI,CAACS,KAAK,EAAE,IAAI,IAAI,CAACf,MAAM,CAACsB,IAAI,EAAE;AACxD,KAAA,CAAC;AACJ;EAGAC,eAAeA,CAACC,IAAO,EAAA;AACrB,IAAA,OAAO,IAAI,CAACpB,aAAa,CAACqB,eAAe,CAACD,IAAI,CAAC;AACjD;EAGAE,KAAKA,CAACC,IAAoB,EAAA;AACxB,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAAC1B,kBAAkB,CAACyB,KAAK,CAACC,IAAI,CAAC,CAAC;AACjE;EAGAE,IAAIA,CAACF,IAAoB,EAAA;AACvB,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAAC1B,kBAAkB,CAAC4B,IAAI,CAACF,IAAI,CAAC,CAAC;AAChE;EAGAG,IAAIA,CAACH,IAAoB,EAAA;AACvB,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAAC1B,kBAAkB,CAAC6B,IAAI,CAACH,IAAI,CAAC,CAAC;AAChE;EAGAI,IAAIA,CAACJ,IAAoB,EAAA;AACvB,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAAC1B,kBAAkB,CAAC8B,IAAI,CAACJ,IAAI,CAAC,CAAC;AAChE;AAGAK,EAAAA,IAAIA,CAACR,IAAO,EAAEG,IAAoB,EAAA;AAChC,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAAC1B,kBAAkB,CAAC+B,IAAI,CAACR,IAAI,EAAEG,IAAI,CAAC,CAAC;AACtE;AAGAM,EAAAA,OAAOA,GAAA;IACL,IAAI,CAACjC,MAAM,CAACkC,UAAU,CAACC,GAAG,CAACC,SAAS,CAAC;AACvC;EAGAC,MAAMA,CAACC,KAAa,EAAA;AAClB,IAAA,IAAI,CAACzB,YAAY,CAACsB,GAAG,CAACG,KAAK,CAAC;AAC9B;AAGAC,EAAAA,MAAMA,CAACC,IAAY,EAAEb,IAAiB,EAAA;AACpC,IAAA,IAAI,CAACC,SAAS,CAACD,IAAI,EAAE,MAAM,IAAI,CAACxB,iBAAiB,CAACoC,MAAM,CAACC,IAAI,CAAC,CAAC;AACjE;AAGAC,EAAAA,QAAQA,GAAA;AACN,IAAA,OAAO,IAAI,CAACtC,iBAAiB,CAACsC,QAAQ,EAAE;AAC1C;EAGAC,MAAMA,CAAClB,IAAQ,EAAA;AACb,IAAA,IAAI,CAACtB,iBAAiB,CAACwC,MAAM,CAAClB,IAAI,CAAC;AACrC;AAGAmB,EAAAA,SAASA,GAAA;AACP,IAAA,IAAI,CAACzC,iBAAiB,CAACyC,SAAS,EAAE;AACpC;EAGAC,QAAQA,CAACpB,IAAQ,EAAA;AACf,IAAA,IAAI,CAACtB,iBAAiB,CAAC0C,QAAQ,CAACpB,IAAI,CAAC;AACvC;AAGAqB,EAAAA,WAAWA,GAAA;AACT,IAAA,IAAI,CAAC3C,iBAAiB,CAAC2C,WAAW,EAAE;AACtC;EAGAC,MAAMA,CAACtB,IAAQ,EAAA;AACb,IAAA,IAAI,CAACtB,iBAAiB,CAAC4C,MAAM,CAACtB,IAAI,CAAC;AACrC;AAGAuB,EAAAA,SAASA,GAAA;AACP,IAAA,IAAI,CAAC7C,iBAAiB,CAAC6C,SAAS,EAAE;AACpC;AAGAC,EAAAA,SAASA,GAAA;AACP,IAAA,IAAI,CAAC9C,iBAAiB,CAAC8C,SAAS,EAAE;AACpC;EAGAC,WAAWA,CAACzB,IAAO,EAAA;AACjB,IAAA,OAAO,IAAI,CAACpB,aAAa,CAAC6C,WAAW,CAACzB,IAAI,CAAC;AAC7C;EAGA0B,eAAeA,CAACvB,IAAmB,GAAA;AAACU,IAAAA,MAAM,EAAE;AAAK,GAAA,EAAA;IAC/C,IAAIV,IAAI,CAACmB,MAAM,EAAE;AACf,MAAA,IAAI,CAAC5C,iBAAiB,CAAC4C,MAAM,EAAE;AACjC;IACA,IAAInB,IAAI,CAACe,MAAM,EAAE;AACf,MAAA,IAAI,CAACxC,iBAAiB,CAACwC,MAAM,EAAE;AACjC;IACA,IAAIf,IAAI,CAACgB,SAAS,EAAE;AAClB,MAAA,IAAI,CAACzC,iBAAiB,CAACyC,SAAS,EAAE;AACpC;IACA,IAAIhB,IAAI,CAACwB,WAAW,EAAE;AACpB,MAAA,IAAI,CAACjD,iBAAiB,CAACiD,WAAW,EAAE;AACtC;AACA,IAAA,IAAI,CAACxB,IAAI,CAACU,MAAM,EAAE;MAChB,IAAI,CAACA,MAAM,CAAC,IAAI,CAACnC,iBAAiB,CAACkD,eAAe,EAAE,CAAC;AACvD;AACF;AAWQxB,EAAAA,SAASA,CAACD,IAAA,GAAmB,EAAE,EAAE0B,SAAwB,EAAA;IAC/D,IAAI1B,IAAI,EAAEwB,WAAW,EAAE;AACrB,MAAA,IAAI,CAACpC,KAAK,CAACoB,GAAG,CAAC,KAAK,CAAC;AACrB,MAAA,IAAI,CAACjC,iBAAiB,CAACkD,eAAe,CAACjB,GAAG,CAAC,IAAI,CAACtB,YAAY,EAAE,CAAC;AACjE;AAEA,IAAA,MAAMyC,KAAK,GAAGD,SAAS,EAAE;AAEzB,IAAA,IAAIC,KAAK,EAAE;AACT,MAAA,IAAI,CAACJ,eAAe,CAACvB,IAAI,CAAC;AAC5B;AAEA,IAAA,IAAI,CAACZ,KAAK,CAACoB,GAAG,CAAC,IAAI,CAAC;AACtB;AACD;;;;"}